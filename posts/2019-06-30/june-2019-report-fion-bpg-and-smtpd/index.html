<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=/favicon.ico><title>June 2019 report: fion, bpg and smtpd - poolp.org</title><meta name=description content="TL;DR: - started working on FION, a static tile window manager - revived BPG, a PGP parser - converted OpenSMTPD to libtls - wrote a library to make writing of native C OpenSMTPD filters easy - started writing a filter-rspamd Thanks to my patrons ! First of all, a huge thanks to my first patrons:
Bleader Raton Diego Meseguer Mischa Peters Vegar Linge Halaand I have recently switched to a 75% part-time schedule at work so that I can spend a &ldquo;free&rdquo; week each month working on my own stuff, mostly opensource, without any kind of pressure: no one knows what I&rsquo;ll be working on and no one but me gets to decide how I&rsquo;ll spend this time."><meta name=generator content="Hugo 0.111.3"><link rel=stylesheet href=https://poolp.org/css/main.css><link rel=stylesheet href=https://poolp.org/css/custom.css><meta property="og:title" content="June 2019 report: fion, bpg and smtpd"><meta property="og:description" content="TL;DR: - started working on FION, a static tile window manager - revived BPG, a PGP parser - converted OpenSMTPD to libtls - wrote a library to make writing of native C OpenSMTPD filters easy - started writing a filter-rspamd Thanks to my patrons ! First of all, a huge thanks to my first patrons:
Bleader Raton Diego Meseguer Mischa Peters Vegar Linge Halaand I have recently switched to a 75% part-time schedule at work so that I can spend a &ldquo;free&rdquo; week each month working on my own stuff, mostly opensource, without any kind of pressure: no one knows what I&rsquo;ll be working on and no one but me gets to decide how I&rsquo;ll spend this time."><meta property="og:type" content="article"><meta property="og:url" content="https://poolp.org/posts/2019-06-30/june-2019-report-fion-bpg-and-smtpd/"><meta property="og:image" content="https://poolp.org/images/poolp_org.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-06-30T07:42:00+00:00"><meta property="article:modified_time" content="2019-06-30T07:42:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://poolp.org/images/poolp_org.png"><meta name=twitter:title content="June 2019 report: fion, bpg and smtpd"><meta name=twitter:description content="TL;DR: - started working on FION, a static tile window manager - revived BPG, a PGP parser - converted OpenSMTPD to libtls - wrote a library to make writing of native C OpenSMTPD filters easy - started writing a filter-rspamd Thanks to my patrons ! First of all, a huge thanks to my first patrons:
Bleader Raton Diego Meseguer Mischa Peters Vegar Linge Halaand I have recently switched to a 75% part-time schedule at work so that I can spend a &ldquo;free&rdquo; week each month working on my own stuff, mostly opensource, without any kind of pressure: no one knows what I&rsquo;ll be working on and no one but me gets to decide how I&rsquo;ll spend this time."><meta itemprop=name content="June 2019 report: fion, bpg and smtpd"><meta itemprop=description content="TL;DR: - started working on FION, a static tile window manager - revived BPG, a PGP parser - converted OpenSMTPD to libtls - wrote a library to make writing of native C OpenSMTPD filters easy - started writing a filter-rspamd Thanks to my patrons ! First of all, a huge thanks to my first patrons:
Bleader Raton Diego Meseguer Mischa Peters Vegar Linge Halaand I have recently switched to a 75% part-time schedule at work so that I can spend a &ldquo;free&rdquo; week each month working on my own stuff, mostly opensource, without any kind of pressure: no one knows what I&rsquo;ll be working on and no one but me gets to decide how I&rsquo;ll spend this time."><meta itemprop=datePublished content="2019-06-30T07:42:00+00:00"><meta itemprop=dateModified content="2019-06-30T07:42:00+00:00"><meta itemprop=wordCount content="3516"><meta itemprop=image content="https://poolp.org/images/poolp_org.png"><meta itemprop=keywords content><meta itemprop=name content="June 2019 report: fion, bpg and smtpd"><meta itemprop=description content="TL;DR: - started working on FION, a static tile window manager - revived BPG, a PGP parser - converted OpenSMTPD to libtls - wrote a library to make writing of native C OpenSMTPD filters easy - started writing a filter-rspamd Thanks to my patrons ! First of all, a huge thanks to my first patrons:
Bleader Raton Diego Meseguer Mischa Peters Vegar Linge Halaand I have recently switched to a 75% part-time schedule at work so that I can spend a &ldquo;free&rdquo; week each month working on my own stuff, mostly opensource, without any kind of pressure: no one knows what I&rsquo;ll be working on and no one but me gets to decide how I&rsquo;ll spend this time."><meta itemprop=datePublished content="2019-06-30T07:42:00+00:00"><meta itemprop=dateModified content="2019-06-30T07:42:00+00:00"><meta itemprop=wordCount content="3516"><meta itemprop=image content="https://poolp.org/images/poolp_org.png"><meta itemprop=keywords content></head><body class="flex relative h-full min-h-screen"><aside class="will-change-transform transform transition-transform -translate-x-full absolute top-0 left-0 md:relative md:translate-x-0 w-3/4 md:basis-60 h-full min-h-screen p-3 bg-slate-50 dark:bg-slate-800 border-r border-slate-200 dark:border-slate-700 flex flex-col gap-2.5 z-20 sidebar flex-shrink-0"><p class="font-bold mb-5 flex items-center gap-2"><button aria-label="Close sidebar" class="md:hidden menu-trigger-close p-1 rounded text-slate-800 dark:text-slate-50 hover:bg-slate-200 dark:hover:bg-slate-700"><svg class="h-6 w-6" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
<a href=https://poolp.org class=px-2><span><img src=/images/poolp_org.png alt=poolp.org></span></a>
<button aria-label="Toggle dark mode" class="dark-mode-toggle p-2 rounded border dark:border-slate-700 hover:bg-slate-200 dark:hover:bg-slate-700"><svg class="h-4 w-4" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="4"/><path d="M3 12h1m8-9v1m8 8h1m-9 8v1M5.6 5.6l.7.7m12.1-.7-.7.7m0 11.4.7.7M6.3 17.7l-.7.7"/></svg></button></p><ul class="list-none flex flex-col gap-1"><li><a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between hover:bg-slate-200 dark:hover:bg-slate-700" href=/><span>Home</span></a></li><li><a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between text-slate-400 font-semibold pb-0 pl-1 border-b cursor-default pointer-events-none" href=#><span>Personal</span></a></li><li><a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between hover:bg-slate-200 dark:hover:bg-slate-700" href=/categories/personal><span>articles</span></a></li><li><a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between text-slate-400 font-semibold pb-0 pl-1 border-b cursor-default pointer-events-none" href=#><span>Technology</span></a></li><li><a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between hover:bg-slate-200 dark:hover:bg-slate-700" href=/categories/technology><span>articles</span></a></li><li><a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between hover:bg-slate-200 dark:hover:bg-slate-700" href=/books/technology><span>books</span></a></li><li><a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between hover:bg-slate-200 dark:hover:bg-slate-700" href=/stack/technology><span>stack</span></a></li><li><a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between text-slate-400 font-semibold pb-0 pl-1 border-b cursor-default pointer-events-none" href=#><span>Music</span></a></li><li><a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between hover:bg-slate-200 dark:hover:bg-slate-700" href=/categories/music><span>articles</span></a></li><li><a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between hover:bg-slate-200 dark:hover:bg-slate-700" href=/stack/music><span>stack</span></a></li><li><a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between text-slate-400 font-semibold pb-0 pl-1 border-b cursor-default pointer-events-none" href=#><span>External</span></a></li><li><a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between hover:bg-slate-200 dark:hover:bg-slate-700" href=https://discord.gg/YC6j4rbvSk target=_blank rel=noopener><span>Discord</span>
<span><svg class="h-4 w-4" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11 7H6A2 2 0 004 9v9a2 2 0 002 2h9a2 2 0 002-2v-5"/><line x1="10" y1="14" x2="20" y2="4"/><polyline points="15 4 20 4 20 9"/></svg></span></a></li><li><a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between hover:bg-slate-200 dark:hover:bg-slate-700" href=https://www.youtube.com/channel/UCU-1Rn7gWhessHWwC3_EsEg target=_blank rel=noopener><span>Youtube</span>
<span><svg class="h-4 w-4" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11 7H6A2 2 0 004 9v9a2 2 0 002 2h9a2 2 0 002-2v-5"/><line x1="10" y1="14" x2="20" y2="4"/><polyline points="15 4 20 4 20 9"/></svg></span></a></li></ul><div class=flex-1></div><ul class="list-none flex flex-wrap justify-center gap-1 pt-2 border-t border-slate-200 dark:border-slate-600"><li><a class="px-2 py-1.5 rounded-md text-sm block text-slate-800 dark:text-slate-50 hover:bg-slate-200 dark:hover:bg-slate-700" href=https://twitter.com/poolpOrg target=_blank rel="noopener noreferrer"><span class=sr-only>Twitter</span>
<span><svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></span></a></li><li><a class="px-2 py-1.5 rounded-md text-sm block text-slate-800 dark:text-slate-50 hover:bg-slate-200 dark:hover:bg-slate-700" href=https://social.poolp.org/@gilles target=_blank rel="noopener noreferrer"><span class=sr-only>Mastodon</span>
<span><svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.6 13.9c-.3 1.5-2.6 3.2-5.3 3.5-1.4.2-2.8.3-4.3.3C9.6 17.5 7.7 17 7.7 17c0 .2.0.5.0.7.3 2.4 2.4 2.5 4.3 2.6 2 .1 3.7-.5 3.7-.5l.1 1.8s-1.4.7-3.8.9c-1.3.1-3 0-4.9-.5-4.2-1.1-4.9-5.6-5-10.1C2 10.4 2 9.1 2 8c0-4.7 3-6 3-6 1.6-.7 4.2-1 7-1h0c2.7.0 5.4.3 6.9 1 0 0 3 1.4 3 6C22 8 22 11.5 21.6 13.9"/><path d="M6.7 13.7s0-4.3.0-5.4c0-1.6 1.1-2.5 2.7-2.5 1.8.0 2.6 1.5 2.6 3 0 .9.0 2.6.0 2.6"/><path d="M17.3 13.7s0-4.3.0-5.4c0-1.6-1.1-2.5-2.7-2.5-1.8.0-2.6 1.5-2.6 3 0 .9.0 2.6.0 2.6"/></svg></span></a></li><li><a class="px-2 py-1.5 rounded-md text-sm block text-slate-800 dark:text-slate-50 hover:bg-slate-200 dark:hover:bg-slate-700" href=https://github.com/poolpOrg target=_blank rel="noopener noreferrer"><span class=sr-only>GitHub</span>
<span><svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></span></a></li><li><a class="px-2 py-1.5 rounded-md text-sm block text-slate-800 dark:text-slate-50 hover:bg-slate-200 dark:hover:bg-slate-700" href=https://linkedin.com/in/gilleschehade target=_blank rel="noopener noreferrer"><span class=sr-only>LinkedIn</span>
<span><svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></span></a></li><li><a class="px-2 py-1.5 rounded-md text-sm block text-slate-800 dark:text-slate-50 hover:bg-slate-200 dark:hover:bg-slate-700" href=mailto:gilles@poolp.org target=_blank rel="noopener noreferrer"><span class=sr-only>Email</span>
<span><svg class="h-4 w-4" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="5" width="18" height="14" rx="2"/><polyline points="3 7 12 13 21 7"/></svg></span></a></li><li><a class="px-2 py-1.5 rounded-md text-sm block text-slate-800 dark:text-slate-50 hover:bg-slate-200 dark:hover:bg-slate-700" href=/index.xml target=_blank rel="noopener noreferrer"><span class=sr-only>RSS</span>
<span><svg class="h-4 w-4" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></span></a></li></ul></aside><div class="fixed bg-slate-700 bg-opacity-5 transition duration-200 ease-in-out inset-0 z-10 pointer-events-auto md:hidden left-0 top-0 w-full h-full hidden menu-overlay"></div><button aria-label="Toggle Sidebar" class="md:hidden absolute top-3 left-3 z-10 menu-trigger p-1 rounded text-slate-800 dark:text-slate-50 hover:bg-slate-100"><svg class="h-6 w-6" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="4" y1="6" x2="20" y2="6"/><line x1="4" y1="12" x2="20" y2="12"/><line x1="4" y1="18" x2="16" y2="18"/></svg></button><div class="flex flex-1 h-screen relative w-full min-w-0"><section class="will-change-transform transform transition-transform -translate-x-[200%] absolute top-0 left-0 lg:relative
lg:translate-x-0 lg:basis-[400px] h-full bg-slate-50 dark:bg-slate-800 border-r border-slate-200 dark:border-slate-700 lg:flex flex-col py-3 overflow-y-auto scroll-area flex-shrink-0"><a href=https://poolp.org/posts/><h2 class="font-bold mb-5 py-1 pl-12 pr-3 md:px-3">Posts</h2></a><label class="mb-2 block px-2"><span></span>
<input type=text placeholder="Search articles" class="searchInput bg-white rounded px-2 py-1 w-full border"></label>
<script>const searchElt=document.querySelector(".searchInput");searchElt&&searchElt.addEventListener("input",e=>{const n=e.target.value||"",t=document.querySelectorAll(".article");n?(t.forEach(e=>e.classList.add("hidden")),Array.from(t).filter(e=>{const t=e.querySelector("h3");return!!t&&t.textContent.toLowerCase().includes(n.toLowerCase())}).forEach(e=>e.classList.remove("hidden"))):t.forEach(e=>e.classList.remove("hidden"))})</script><div class=space-y-2.5><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2023-06-30/2023-q2-music-unity-xgb-jujulang-setdb-and-opensmtpd/><h3 class="text-lg font-semibold mb-0.5">2023-Q2: music, unity, xgb, jujulang, setdb and opensmtpd</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: Received the neck... too bad it's not exactly the one I ordered :-) Shout out to my sponsors ❤️ A HUGE thanks goes to my sponsors on github and patreon: your continuous support is very much appreciated !
I created a Discord where I hang out and discuss my projects or screencast as I work on them. Feel free to hop in if you want, and feel free to do just like me and share thoughts as you work on your own projects there: this is a virtual hack room for anyone to join: https://discord.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2023-06-29/building-my-own-guitar-part-2/><h3 class="text-lg font-semibold mb-0.5">Building my own guitar, part 2</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: Received the neck... too bad it's not exactly the one I ordered :-) The neck For the neck, I wanted a 24 frets neck and found one that I liked online.
Upon delivery today, I realized that they didn&rsquo;t ship the correct one, but a 22 frets neck instead (see picture above). So while it still looks very nice, it&rsquo;s not exacrly what I wanted, and it also doesn&rsquo;t fit quite right in the body despite an announced compatible size: turns out that in guitar making, millimeters do matter.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2023-06-28/building-my-own-guitar-part-1/><h3 class="text-lg font-semibold mb-0.5">Building my own guitar, part 1</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: I'm building a guitar from scratch, picking up every component but skipping the tricky cut and glue bits :-) About this project The primary goal of this project is to build a custom guitar, picking each and every component one by one, so that it&rsquo;s 100% what I want it to be.
The second goal is to set myself a reasonnable objective, by not having to cut and glue wood myself, so that I can see if I like building guitars at all.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2023-06-25/a-new-section-appeared/><h3 class="text-lg font-semibold mb-0.5">A new section appeared !</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: I will be discussing music on this blog from now on. This blog is a musical blog too As some of you know, I have a deep interest for music.
This blog section will focus on music-related topics, from a listener, amateur musician and/or producer point of view.
I will sometimes post links to music I want to share, either because I did it, or because I like it, but I will also write articles and share hardware and software reviews.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2023-04-02/march-2023-melodya-mhl-midi-csv-and-more.../><h3 class="text-lg font-semibold mb-0.5">March 2023: Melodya, MHL, MIDI-csv and more...</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: I played with MIDI and ChatGPT. Shout out to my sponsors ❤️ A HUGE thanks goes to my sponsors on github and patreon: your continuous support is very much appreciated !
I created a Discord where I hang out and discuss my projects or sometimes screencast as I work on them. Feel free to hop in if you want, and feel free to do just like me and share thoughts as you work on your own projects there: this is a virtual hack room for anyone to join: https://discord.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2023-03-01/i-love-you/><h3 class="text-lg font-semibold mb-0.5">I love you</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">Almost four years ago, your mom and I left home and rushed to the maternity hospital to give birth to your brother. As I closed the door to our home, I told your mom with a huge smile that the next time we&rsquo;d open the door we&rsquo;d no longer be only the two of us. This was the best day of our lives.
In December, we got the news that your mom was pregnant of you.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2022-12-30/december-2022-some-more-earmuff-and-go-harmony/><h3 class="text-lg font-semibold mb-0.5">December 2022: some more earmuff and go-harmony</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: I worked on earmuff and go-harmony, I played with ChatGPT. Shout out to my sponsors ❤️ A HUGE thanks goes to my sponsors on github and patreon: your continuous support is very much appreciated !
I created a Discord where I hang out and discuss my projects or sometimes screencast as I work on them. Feel free to hop in if you want, and feel free to do just like me and share thoughts as you work on your own projects there: this is a virtual hack room for anyone to join: https://discord.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2022-11-30/november-2022-feedchain-go-harmony-dart-harmony-and-harmonee/><h3 class="text-lg font-semibold mb-0.5">November 2022: feedchain, go-harmony, dart-harmony and harmonee</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: busy month, did a lot of non tech stuff, but also worked on a new project called feedchain, fixed issues and added new features to go-harmony, and started two projects called dart-harmony and harmonee, both related to music. Shout out to my sponsors ❤️ A HUGE thanks goes to my sponsors on github and patreon: your continuous support is very much appreciated !
I created a Discord where I hang out and discuss my projects or sometimes screencast as I work on them.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2022-11-20/feedchain-is-a-standalone-news-feed-project/><h3 class="text-lg font-semibold mb-0.5">Feedchain is a standalone news feed project</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: I implemented a file format to support a standalone feed of news similar to what I have on Twitter, as well as a proof of concept code for a reader, a writer, a publishing node, and some more. oh and fuck you, elon, you're a dick. Shout out to my sponsors ❤️ A HUGE thanks goes to my sponsors on github and patreon: your continuous support is very much appreciated !</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2022-10-18/october-2022-blog-comments-a-bit-of-plakar-and-the-streamchain-project/><h3 class="text-lg font-semibold mb-0.5">October 2022: blog comments, a bit of plakar and the streamchain project</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: added comments support to the blog, did some music and hypnosis projects, fixed a few bugs in plakar and began a new toy project. Shout out to my sponsors ❤️ A HUGE thanks goes to my sponsors on github and patreon: your continuous support is very much appreciated !
I created a Discord where I hang out and discuss my projects or screencast as I work on them. Feel free to hop in if you want, and feel free to do just like me and share thoughts as you work on your own projects there: this is a virtual hack room for anyone to join: https://discord.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2022-06-14/june-2022-go-harmony-and-earmuff/><h3 class="text-lg font-semibold mb-0.5">June 2022: go-harmony and earmuff</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: did a lot of music, even while writing code. Shout out to my sponsors ❤️ A HUGE thanks goes to my sponsors on github and patreon: your continuous support is very much appreciated !
I created a Discord where I hang out and discuss my projects or screencast as I work on them. Feel free to hop in if you want, and feel free to do just like me and share thoughts as you work on your own projects there: this is a virtual hack room for anyone to join: https://discord.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2022-05-22/may-2022-yet-again-tons-of-plakar-stuff/><h3 class="text-lg font-semibold mb-0.5">May 2022: yet again, tons of plakar stuff</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: tons of plakar work, most notably on indexes, performances, clone & sync and fuse. Shout out to my sponsors ❤️ A HUGE thanks goes to my sponsors on github and patreon: your continuous support is very much appreciated !
I created a Discord where I hang out and discuss my projects or screencast as I work on them. Feel free to hop in if you want, and feel free to do just like me and share thoughts as you work on your own projects there: this is a virtual hack room for anyone to join: https://discord.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2022-04-24/april-2022-plakar.io-plakar-refactor-and-ssh-support/><h3 class="text-lg font-semibold mb-0.5">April 2022: plakar.io, plakar refactor and ssh support</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: I refactored internal structures to split metadata from the index, implemented an stdio server and finally added SSH support. Shout out to my sponsors ❤️ A HUGE thanks goes to my sponsors on github and patreon: your continuous support is very much appreciated !
I created a Discord where I hang out and discuss my projects or screencast as I work on them. Feel free to hop in if you want, and feel free to do just like me and share thoughts as you work on your own projects there: this is a virtual hack room for anyone to join: https://discord.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2022-04-01/april-2022-plakar-keys-and-ui-stuff/><h3 class="text-lg font-semibold mb-0.5">April 2022: plakar keys and UI stuff</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: I did key and UI stuff, mostly search related. There's going to be plenty of images in this post. Shout out to my sponsors ❤️ A HUGE thanks goes to my sponsors on github and patreon: your continuous support is very much appreciated !
I created a Discord where I hang out and discuss my projects or screencast as I work on them. Feel free to hop in if you want, and feel free to do just like me and share thoughts as you work on your own projects there: this is a virtual hack room for anyone to join: https://discord.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2022-03-06/march-2022-plakar-clone-and-plakar-sync/><h3 class="text-lg font-semibold mb-0.5">March 2022: plakar clone and plakar sync</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: implemented cloning and synchronization between plakar repositories Shout out to my sponsors ❤️ A HUGE thanks goes to my sponsors on github and patreon: your continuous support is very much appreciated !
I created a Discord where I hang out and discuss my projects or screencast as I work on them. Feel free to hop in if you want, and feel free to do just like me and share thoughts as you work on your own projects there: this is a virtual hack room for anyone to join: https://discord.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2021-12-30/farewell-2021-welcome-2022-a-personal-post/><h3 class="text-lg font-semibold mb-0.5">Farewell 2021, Welcome 2022: a personal post</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: A retrospective of 2021 2021 was a good year overall Pandemic and lock-downs set aside, 2021 was a good year overall.
I&rsquo;ve really enjoyed my daytime job, my physical health was fine, my mental health was&mldr; meh&mldr; but ok, I guess.
Learnt about my neuro-divergences I took a psychological assessment which pinpointed what&rsquo;s &ldquo;wrong&rdquo; with me, the source of my alexithymia, generalized anxiety disorder and life-long uneasy feeling.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2021-12-13/december-2021-a-bit-of-plakar-a-bit-of-go-fastcdc-and-some-useless-stuff/><h3 class="text-lg font-semibold mb-0.5">December 2021: a bit of plakar, a bit of go-fastcdc and some useless stuff</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: I worked on plakar, go-fastcdc a FastCDC implementation for plakar, and some useless stuff. Shout out to my sponsors ❤️ A HUGE thanks goes to my sponsors on github and patreon: your continuous support is very much appreciated !
I created a Discord where I hang out and discuss my projects or screencast as I work on them. Feel free to hop in if you want, and feel free to do just like me and share thoughts as you work on your own projects there: this is a virtual hack room for anyone to join: https://discord.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2021-10-26/november-2021-a-bit-of-go-ipcmsg-a-bit-of-go-privsep-and-a-ton-of-plakar/><h3 class="text-lg font-semibold mb-0.5">November 2021: a bit of go-ipcmsg, a bit of go-privsep and a ton of plakar</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: I still have a discord, [https://discord.gg/YC6j4rbvSk](https://discord.gg/YC6j4rbvSk), feel free to join. I worked on go-ipcmsg to make it nicer, go-privsep to make it more useable, and A LOT on plakar to make it plakar. Shout out to my sponsors ❤️ A HUGE thanks goes to my sponsors on github and patreon: your continuous support is very much appreciated !
I created a Discord where I hang out and discuss my projects or screencast as I work on them.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2021-10-26/october-2021-mostly-plakar/><h3 class="text-lg font-semibold mb-0.5">October 2021: mostly Plakar</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: I have a discord now, [https://discord.gg/YC6j4rbvSk](https://discord.gg/YC6j4rbvSk), feel free to join. I refactored plakar, implemented a local cache, improved parallelism, modified the push strategy, played with fuse and networking. I also did other stuff but let's keep that out of this article. Shout out to my sponsors ❤️ A HUGE thanks goes to my sponsors on github and patreon: your continuous support is very much appreciated !
I have a discord now I have a rubber duck sitting on my desk&mldr;</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2021-08-13/august-2021-taking-a-break/><h3 class="text-lg font-semibold mb-0.5">August 2021: taking a break</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: - this is a short article, no TL;DR. Why so calm ? As some of you know, I was diagnosed a few years ago with generalized anxiety disorder, panic disorder and alexithymia, a trait that makes it particularly difficult for me to cope with the disorders.
As I wrote in 2019, I didn&rsquo;t take the alexithymia diagnosis too well. It took me a long time to stop ruminating, move forward, and start trying to find a fix for myself with virtually no help.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2021-05-02/><h3 class="text-lg font-semibold mb-0.5">Mind hacking: comprendre comment fonctionne notre esprit</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: J'explique superficiellement comment fonctionne notre esprit, en partant du corps, puis de notre sens de la réalité, avant de finir par les états de conscience et personnalités. Je plonge brièvement dans les rêves et l'hypnose, préparant le terrain pour un article à venir. Avertissement Mon intérêt pour les rêves lucides a débuté aux alentours de 2013, j&rsquo;ai étudié seul puis suivi différentes formations de différent type d&rsquo;hypnose entre 2015 et 2020, et je pratique l&rsquo;hypnose en cabinet depuis 2016 jusqu&rsquo;à maintenant.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2021-05-01/><h3 class="text-lg font-semibold mb-0.5">Mind hacking: understanding how our mind works</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: I explain very superficially how our minds work, starting from our body, following with our sense of reality, and ending with our states of consciousness and personalities. I dive briefly into dreams and hypnosis, paving the road for a future article. Disclaimer I&rsquo;ve started taking an interest in lucid dreaming around 2013, self-studying and training in various kinds of hypnosis from 2015 to 2020, and been working as a hypnotherapist since 2016 up to now.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2021-04-30/april-2021-opensmtpd-plakar-ipcmsg-privsep-and-a-small-hypnosis-talk/><h3 class="text-lg font-semibold mb-0.5">April 2021: OpenSMTPD, plakar, ipcmsg, privsep and a small hypnosis talk</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: I worked on OpenSMTPD-portable, did a lot of plakar, a lot of Go and gave a technical talk on hypnosis. Shout outs to my patrons ! A huge thanks goes to the people sponsoring me on patreon, github or liberaPay, the work in this post was made possible by my sponsors.
Let&rsquo;s start with some LoFi Relax.
I have a youtube channel (subscribe ! now !)
This one caused me a copyright strike so I hope it was worth it :-)</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2021-03-26/march-2021-backups-with-plakar/><h3 class="text-lg font-semibold mb-0.5">March 2021: backups with Plakar</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: I wrote a backup utility called plakar. Shout outs to my patrons ! As usual, a huge thanks goes to the people sponsoring me on patreon, github or liberaPay, the work in this post was made possible by my sponsorship.
Let&rsquo;s start with some LoFi Relax.
I have a youtube channel (subscribe ! now !)
Plakar: Yet another backup utility ? Yes, I wrote another backup utility.
I backup many hosts on a daily basis and while there are many different tools, I always fallback to using scripts built on top of rsync to do incremental backups, which always results in customization for this or that host.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2021-02-28/february-2021-noosmtpd-libtls-conversion-ciphers-curves-and-protocols/><h3 class="text-lg font-semibold mb-0.5">February 2021: nooSMTPD libtls-conversion, ciphers, curves and protocols</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: I converted nooSMTPD to libtls and implemented SMTP ciphers, curves and protocols selection. Shout outs to my patrons ! As usual, a huge thanks goes to the people sponsoring me on patreon, github or liberaPay, the work in this post was made possible by my sponsorship.
Let&rsquo;s start with some LoFi Relax.
I have a youtube channel (subscribe ! now !)
Nothing new in OpenSMTPD-portable eric@ sent a libtls-conversion diff to tech@ last month but there hasn&rsquo;t been much progress since then.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2021-01-31/january-2021-opensmtpd-libtls-conversion-and-unix-domain-sockets-support-noosmtpd/><h3 class="text-lg font-semibold mb-0.5">January 2021: OpenSMTPD libtls conversion and UNIX-domain sockets support, nooSMTPD</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: I do LoFi now, eric@ revived some libtls conversion work I did a while back, I worked on UNIX-domain sockets support in OpenSMTPD, a few words about nooSMTPD Shout outs to my patrons ! As usual, a huge thanks goes to the people sponsoring me on patreon, github or liberaPay, the work in this post was made possible by my sponsorship.
Let&rsquo;s start with some LoFi Relax.
I have a youtube channel (subscribe !</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2020-12-29/writing-a-custom-mail-delivery-agent/><h3 class="text-lg font-semibold mb-0.5">Writing a custom Mail Delivery Agent</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: In this article, I explain what is an MDA and how to write a custom one from scratch using only shell scripting. Shout outs to my patrons ! As usual, a huge thanks goes to the people sponsoring me on patreon, github or liberaPay, the work in this post was made possible by my sponsorship.
What is a Mail Delivery Agent (MDA) ? When a mail enters an SMTP server it is initially stored in the server queue before being moved to its next destination.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2020-12-24/december-2020-opensmtpd-6.8.0p1-released-fixed-several-bugs-proposed-several-diffs-book-is-on-github/><h3 class="text-lg font-semibold mb-0.5">December 2020: OpenSMTPD 6.8.0p1 released, fixed several bugs, proposed several diffs, book is on Github</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: - Crafted the OpenSMTPD 6.8.0p1 release - Fixed several bugs in the way - Proposed a few OpenSMTPD improvements to OpenBSD - Working on my OpenSMTPD book Shout outs to my patrons ! As usual, a huge thanks goes to the people sponsoring me on patreon, github or liberaPay, the work in this post was made possible by my sponsorship.
Let&rsquo;s start with some LoFi Relax.
About sponsorship First of all, I must say how grateful and happy I am that people value my work enough to trust and sponsor me, I appreciate it a lot and it is a huge motivation booster.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2020-11-22/november-2020-i-wasnt-slacking-but-no-opensource-work/><h3 class="text-lg font-semibold mb-0.5">November 2020: I wasn't slacking but no opensource work</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: Haven't posted since July but I wasn't slacking, got temporarily context-switched out of opensource stuff. I tanked a year in work psychology As some of you know, I study work psychology and have been attending evening classes for the last four years, sometimes up to 9 hours / week and more often between 3 and 6 hours / week. I&rsquo;m pretty invested as you can tell, it&rsquo;s a lot of time that I could spend in bed but that I spend in class instead :-)</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2020-07-31/july-2020-webmail-custom-mda-and-python-framework-work/><h3 class="text-lg font-semibold mb-0.5">July 2020: webmail, custom MDA and python framework work</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: worked on my webmail, on a custom MDA and on a python framework for API development. Shout outs to my patrons ! As usual, a huge thanks goes to the people sponsoring me on patreon or github, the work in this post was made possible by my sponsorship.
Worked on my webmail Again, I&rsquo;d like to emphasize that this is something that&rsquo;s going to span over many months so&mldr; don&rsquo;t hold your breath.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2020-06-27/june-2020-poolp.org-folder-pinning-and-webmail-work/><h3 class="text-lg font-semibold mb-0.5">June 2020: poolp.org, folder pinning and webmail work</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: Reworked my infrastructure at poolp.org, implemented folder pinning, worked on my webmail. Shout outs to my patrons ! As usual, a huge thanks goes to the people sponsoring me on patreon or github, the work in this post was made possible by my sponsorship.
poolp.org infrastructure rework I decided to move my servers from online.net to vultr.com (affiliation link).
I have been at online.net for hosting since 2007 and have always been happy with their services, however OpenBSD has never been supported there and I always had to use custom install procedures and hope things go well.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2020-05-28/may-2020-opensmtpd-6.7.1p1-release-table-procexec-and-many-pocs/><h3 class="text-lg font-semibold mb-0.5">May 2020: OpenSMTPD 6.7.1p1 release, table-procexec and many PoCs</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: Worked on the OpenSMTPD 6.7 release; Did a lot of work on the new table API; Wrote several PoCs; WARNING:
Examples of code and configuration that appear in this article are here to help illustrate and explain development stages of my work.
They are subject to changes and must not be considered as user documentation. By the time you&rsquo;re reading this, they will likely no longer work or reflect reality.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2020-05-01/april-2020-worked-on-a-webmail-and-a-bit-of-opensmtpd-too/><h3 class="text-lg font-semibold mb-0.5">April 2020: worked on a webmail and a bit of OpenSMTPD too</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: Worked on my webmail; Did a bit of OpenSMTPD work; Shout outs to my patrons ! As usual, a huge thanks goes to the people sponsoring me on patreon or github, the work in this post was made possible by my sponsorship.
Webmail vs mutt I started using console clients to read my mail back when I was a student in early 2000s, and I&rsquo;ve been using mutt for as long as I can recall now.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2020-03-30/anxiety-openbsd-break-covid-19-and-resuming-work/><h3 class="text-lg font-semibold mb-0.5">Anxiety, OpenBSD break, COVID-19 and resuming work</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: - I took a break to deal with personal stuff - I'm taking a long break from OpenBSD for personal reasons - I may or may not have experienced COVID-19, who knows - resumed work on OpenSMTPD and other projects This is a weird report This is a weird report.
I&rsquo;ll mix a bit of personal info to provide some context as to why I decided to leave the OpenBSD project, explain why this doesn&rsquo;t mean I won&rsquo;t be an active contributor, and give some small insight into my upcoming work.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2020-01-30/opensmtpd-advisory-dissected/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD advisory dissected</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: - Qualys released an advisory for a bad, bad vulnerability - an MTA is a very bad software to have a vulnerability in - hole was plugged but that's not enough, similar bugs should be mitigated in the future - article discusses what could have prevented escalation despite the bug What happened ? Qualys contacted by e-mail to tell me they found a vulnerability in OpenSMTPD and would send me the encrypted draft for advisory.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2020-01-22/january-2020-opensmtpd-work-libasr-and-libtls/><h3 class="text-lg font-semibold mb-0.5">January 2020: OpenSMTPD work - libasr and libtls</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: - brought back libasr to OpenSMTPD, it is no longer an external dependency - libtls-enabled OpenSMTPD is now a thing - documented filters and improved reporting Shout outs to my sponsors ! As usual, a huge thanks goes to the people sponsoring me on patreon or github, the work in this post was made possible by my sponsorship.
If you like my work, you can join my sponsors or share my reports and articles to help me find more people willing to sponsor me !</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2019-12-26/spf-aware-greylisting-et-filter-greylist/><h3 class="text-lg font-semibold mb-0.5">SPF-aware greylisting et filter-greylist</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: - le greylisting est une bonne idée - ce n'est pas très pratique aujourd'hui - beaucoup de gens se passent du greylisting ou trouvent des contournements - le SPF-aware greylisting rend le greylisting utilisable à nouveau Merci à mes sponsors ! Un énorme merci aux gens qui me sponsorisent sur patreon ou github, le temps consacré à la rédaction et traduction de cet article a été rendu possible par mon sponsorat.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2019-12-24/december-2019-opensmtpd-and-filters-work-articles-and-goodies/><h3 class="text-lg font-semibold mb-0.5">December 2019: OpenSMTPD and filters work, articles and goodies</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: - wrote, reworked and translated multiple articles this month - got some goodies ready for my patrons - lots of work in OpenSMTPD's grammar, documentation and filters protocol WARNING:
Examples of code and configuration that appear in this article are here to help illustrate and explain development stages of my work.
They are subject to changes and must not be considered as user documentation. By the time you&rsquo;re reading this, they will likely no longer work or reflect reality.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2019-12-23/mettre-en-place-un-serveur-de-mail-avec-opensmtpd-dovecot-et-rspamd/><h3 class="text-lg font-semibold mb-0.5">Mettre en place un serveur de mail avec OpenSMTPD, Dovecot et Rspamd</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: - Pas de résumé, j'ai passé des heures à traduire, vous allez passer des minutes à lire ;) - OK… J'ai expliqué avec BIEN TROP DE DÉTAILS comment mettre en place un serveur de mail Merci à mes sponsors ! Un énorme merci aux gens qui me sponsorisent sur patreon ou github, le temps consacré à la rédaction et traduction de cet article a été rendu possible par mon sponsorat.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2019-12-15/decentralisons-smtp-pour-le-bien-commun/><h3 class="text-lg font-semibold mb-0.5">Décentralisons SMTP pour le bien commun</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: - SMTP est la méthode dont les ordinateurs échangent des e-mails - il s'agit d'un protocole décentralisé, ce qui signifie que CHACUN peut héberger un nœud et être indépendant - il est en train d'être centralisé dans des sociétés qui ont un passif d'abus - il est en train d'être centralisé dans un pays qui a un passif d'abus Où est-ce que j&rsquo;ai déjà lu ça ? En Août, j&rsquo;ai publié un petit article intitulé &ldquo;You should not run your mail server because mail is hard&rdquo; (&ldquo;Vous ne devriez pas héberger votre serveur de mail parce que c&rsquo;est dur&rdquo;) qui était, en gros, mon opinion sur les différentes raisons qui poussent les gens à décourager l&rsquo;hébergement de mails.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2019-12-15/decentralised-smtp-is-for-the-greater-good/><h3 class="text-lg font-semibold mb-0.5">Decentralised SMTP is for the greater good</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: - SMTP is the way computers exchange e-mails - it is a decentralised protocol meaning that ANYONE can run a node and be independant - it is being centralised at companies that have a history of abuse - it is being centralised in a country that has a history of abuse Where did you read this already ? In August, I published a small article titled &ldquo;You should not run your mail server because mail is hard&rdquo; which was basically my opinion on why people keep saying it is hard to run a mail server.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2019-12-01/spf-aware-greylisting-and-filter-greylist/><h3 class="text-lg font-semibold mb-0.5">SPF-aware greylisting and filter-greylist</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: - greylisting is a sound idea - yet it is not really practical today - people tend to disable it or find work-arounds - SPF-aware greylisting makes greylisting usable again Shout outs to my sponsors ! As usual, a huge thanks goes to the people sponsoring me on patreon or github, the work in this post was made possible by my sponsorship.
SMTP failures in a nutshell SMTP is a fail-safe protocol which attempts very hard to ensure that messages do not get lost once they are in transit.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2019-11-17/november-2019-report-opensmtpd-6.6.1p1-filter-greylist-and-tons-of-portable-cleanup/><h3 class="text-lg font-semibold mb-0.5">November 2019 report: OpenSMTPD 6.6.1p1, filter-greylist and tons of portable cleanup</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: - our CI was improved - a new OpenSMTPD release, 6.6.1p1 took place to deal with portable issues - multiple portability issues were adressed - new table API in the works - filter-rspamd and filter-senderscore were improved - filter-greylist proof-of-concept published - wrote 2 chapters for my book Shout outs to my sponsors ! As usual, a huge thanks goes to the people sponsoring me on patreon or github, the work in this post was made possible by my sponsorship.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2019-10-26/october-2019-report-opensmtpd-6.6.0-release-mostly/><h3 class="text-lg font-semibold mb-0.5">October 2019 report: OpenSMTPD 6.6.0 release mostly</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: - yay, surprise emergency hand surgery... - OpenSMTPD 6.6.0 was tagged and released, including portable version - Merged contributions to fix filter-rspamd bug with DKIM - Work resumed on 6.7.0 feature - An OpenSMTPD book is in the works Shout outs to my patrons ! As usual, a huge thanks goes to the people sponsoring me on patreon or github, the work in this post was made possible by my sponsorship.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2019-09-21/september-2019-report-jules-opensmtpd-6.6.0-upcoming-release-and-related-things/><h3 class="text-lg font-semibold mb-0.5">September 2019 report: Jules, OpenSMTPD 6.6.0 upcoming release and related things</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: - I started writing this post a week ago but got interrupted by a baby, Jules - Spent MANY hours on writing OpenSMTPD-related articles - Enabled continuous integration in the OpenSMTPD portable repository - Managed to get rid of all the blocking issues for OpenSMTPD 6.6.0 release - Added some features and fixed a crash in filter-rspamd Shout outs to my patrons ! As usual, a huge thanks goes to the people sponsoring me on patreon or github, the work in this post was made possible by my sponsorship.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2019-09-14/setting-up-a-mail-server-with-opensmtpd-dovecot-and-rspamd/><h3 class="text-lg font-semibold mb-0.5">Setting up a mail server with OpenSMTPD, Dovecot and Rspamd</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: - NO TL;DR: this time, I spent hours writing, you should spend minutes reading. - OK... I explain in WAY TOO MUCH details how to setup a mail server EDIT (2019-10-26) OpenSMTPD 6.6.0 was released today, the article was updated to reflect that it applies to the current release and no longer a development version.
EDIT (2019-12-15) I have refactored the article to remove the political aspect behind self-hosting, which is now a standalone article, as well as a blurb on reputation since this will become part of a serie of articles.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2019-08-30/you-should-not-run-your-mail-server-because-mail-is-hard/><h3 class="text-lg font-semibold mb-0.5">You should not run your mail server because mail is hard</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: - Mail is not hard: people keep repeating that because they read it, not because they tried it - Big Mailer Corps are quite happy with that myth, it keeps their userbase growing - Big Mailer Corps control a large percentage of the e-mail address space which is good for none of us - It's ok that people have their e-mails hosted at Big Mailer Corps as long as there's enough people outside too EDIT (2019-12-15) A practical guide to set up a mail exchanger was published on this blog.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2019-08-25/august-2019-report-fion-plakar-and-opensmtpd/><h3 class="text-lg font-semibold mb-0.5">August 2019 report: Fion, Plakar and OpenSMTPD</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">Tl;DR: - small inprovements to the fion window manager - plakar is a backup utility I wrote a long time ago that I will share - tons of opensmtpd stuff, mostly filters and issues handling Shout outs to my patrons ! As has become the habit, this report begins with a big thank you to my patrons, cited by contribution then alphabetical order.
This month has been sponsored by:
J. Derrick Wesley Mouedine Assaby Mischa Peters Diego Meseguer Edgar Pettijohn Jdelic Sean Geoff Hill Thomas Bleader Raton Nick Ryan Vegar Linge Halaand Igor Zinovik Paul Kelly Jan J C I have recently switched to a 75% part-time schedule at work so that I can spend a &ldquo;free&rdquo; week each month working on my own stuff, mostly opensource, without any kind of pressure: no one knows what I&rsquo;ll be working on and no one but me gets to decide how I&rsquo;ll spend this time.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2019-07-27/july-2019-report-tons-of-smtpd-work-mostly/><h3 class="text-lg font-semibold mb-0.5">July 2019 report: tons of smtpd work mostly</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: - not much work outside of OpenSMTPD this week - OpenSMTPD portable builds with OpenSSL 1.1.x again - smtp-out reporting is working correctly on my laptop - wrote two filters that I'm actually using as you read this Shout outs to my patrons ! As will become the tradition hopefully, this report begins with a big thank you to my patrons, cited by contribution then alphabetical order.
This month has been sponsored by:</div></a><a class="article block px-3 py-4 bg-slate-900 dark:bg-slate-700 text-slate-50" href=/posts/2019-06-30/june-2019-report-fion-bpg-and-smtpd/><h3 class="text-lg font-semibold mb-0.5">June 2019 report: fion, bpg and smtpd</h3><div class="text-sm text-slate-400 line-clamp-2">TL;DR: - started working on FION, a static tile window manager - revived BPG, a PGP parser - converted OpenSMTPD to libtls - wrote a library to make writing of native C OpenSMTPD filters easy - started writing a filter-rspamd Thanks to my patrons ! First of all, a huge thanks to my first patrons:
Bleader Raton Diego Meseguer Mischa Peters Vegar Linge Halaand I have recently switched to a 75% part-time schedule at work so that I can spend a &ldquo;free&rdquo; week each month working on my own stuff, mostly opensource, without any kind of pressure: no one knows what I&rsquo;ll be working on and no one but me gets to decide how I&rsquo;ll spend this time.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2019-06-02/may-2019-report/><h3 class="text-lg font-semibold mb-0.5">May 2019 report</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: In this post I explain crudely how ca.c works and changes to OpenSMTPD related to ca.c I wrote an ECDSA privsep crypto engine I did some EEG work too This is the first report I will now switch to a monthly report of my tech activities on this blog, and this is the first post in that new format.
The focus will be put on interesting topics, not necessarily every single commit and bug fix I do (ie: won&rsquo;t mention LMTP bug fix here), this depends on the amount of slacking that ocurred during the month and how much I want to cover it up :-)</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2019-06-02/happy-new-year-2019-a-personal-post/><h3 class="text-lg font-semibold mb-0.5">happy new year 2019, a personal post</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: Way too many things happened in a six months timeframe. This post won't need a TL;DR as I'll keep it short. Generalized anxiety disorder and alexithymia. Late 2018, I&rsquo;ve been diagnosed with generalized anxiety disorder and alexithymia a couple weeks apart.
The anxiety disorder didn&rsquo;t really come as a surprise as I know very well the traumatic experience that led to the disorder. It&rsquo;ll still take a lot of hours of hypnosis to continue cleaning up trauma after trauma, but taking care of it and releasing some of the traumas has improved considerably my anxiety.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2018-12-21/opensmtpd-now-supports-regex-in-match-rules/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD now supports regex in match rules</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: regex table lookups were introduced for builtin filters. After a few weeks of working solely on filters, I wanted to work on something else. Using the same mechanism, all match criterias using tables can support regex. K_REGEX lookups The table mechanism is used within OpenSMTPD to perform all kinds of lookups.
Recently, while working on builtin filters, I introduced the K_REGEX lookup type allowing tables to serve regex(3) patterns.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2018-12-19/more-on-opensmtpd-filters/><h3 class="text-lg font-semibold mb-0.5">more on OpenSMTPD filters</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: Not this time, pal/gal, I took hours writing this post, you'll take a few minutes reading it all. Oh, and merry X-mas :-* A bit of short-sighted history The filtering feature has been introduced only recently in OpenSMTPD, first presented on this blog a month ago.
I had a working proof-of-concept running on my laptop and my plan was to start bringing the code to the OpenBSD tree, small chunks by small chunks, through a serie of diffs.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2018-12-06/opensmtpd-proc-filters-fc-rdns/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD proc filters & fc-rDNS</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: I *FINALFUCKINGLY* commited proc filters support allowing full filtering in OpenSMTPD. eric@ implemented fc-rDNS lookups. fc-rDNS fc-rDNS, or forward-confirmed reverse DNS, consists in performing a reverse DNS lookup to determine the hostname associated to an IP address&mldr; then performing a DNS lookup on that hostname to check if it resolves back to the IP address.
On my request, eric@ implemented fc-rDNS lookups in our SMTP engine, causing OpenSMTPD to perform the double lookup upon clients connections.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2018-11-09/opensmtpd-reporting-update/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD reporting update</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: The reporting mechanism has been described shortly in my previous article about both reporting and filters. Let's focus a bit more on the reporting bits this time. The format is improving further and has extended to outgoing trafic reporting. Reporting In previous article, I described the events reporting mechanism that has been introduced in the development branch of OpenSMTPD.
To sum it up, you could now write an event processor as simple as a shell script reading its stdin on a loop:</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2018-11-03/opensmtpd-released-and-upcoming-filters-preview/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD released and upcoming filters preview</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: Filters have been a (the most ?) long awaited feature in OpenSMTPD. I finally committed most of the filters code to OpenBSD. There is still a bit of work required but the trickiest parts are done. This article describes how filters are implemented and what to expect. OpenSMTPD 6.4.0 was released ! We have released OpenSMTPD 6.4.0 last week without filters.
I won&rsquo;t expand on the features in the 6.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2018-05-21/switching-to-opensmtpd-new-config/><h3 class="text-lg font-semibold mb-0.5">switching to OpenSMTPD new config</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: Switching to new config is not too hard and can be done in minutes. The new config is also a new queue that is not backwards compatible. The easiest way is to flush the mail queue before switching. We came up with a solution to help maintainers of more complex setups. Switching from old config to new config The new OpenSMTPD configuration grammar is slightly different from the current one, rules are no longer stated as single lines, but the conversion from previous ruleset to new ruleset isn&rsquo;t that hard.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2018-04-30/opensmtpd-new-config/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD new config</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: OpenBSD #p2k18 hackathon took place at Epitech in Nantes. I was organizing the hackathon but managed to make progress on OpenSMTPD. As mentionned at EuroBSDCon the one-line per rule config format was a design error. A new configuration grammar is almost ready and the underlying structures are simplified. Refactor removes ~750 lines of code and solves _many_ issues that were side-effects of the design error. New features are going to be unlocked thanks to this.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2018-01-29/install-openbsd-on-dedibox-with-full-disk-encryption/><h3 class="text-lg font-semibold mb-0.5">Install OpenBSD on dedibox with full-disk encryption</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: I run several "dedibox" servers at online.net, all powered by OpenBSD. OpenBSD is not officially supported so you have to work-around. Running full-disk encrypted OpenBSD there is a piece of cake. As a bonus, my first steps within a brand new booted machine ;-) Step #0: choosing your server OpenBSD is not officially supported, I can&rsquo;t guarantee that this will work for you on any kind of server online.net provides, however I&rsquo;ve been running https://poolp.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2018-01-08/spfwalk/><h3 class="text-lg font-semibold mb-0.5">spfwalk</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: deraadt@ thought it would be nice to have a spf fetch utility in base. Aaron Poffenberger wrote a shell-based `spf_fetch` utility. I wrote a C-based `spfwalk` utility that's `pledge()`-ed. The `spfwalk` utility got merged to `smtpctl`. What&rsquo;s SPF in a few words SPF is the Sender Policy Framework, a standard to verify the domain name of an e-mail sender.
Long story short, the SMTP protocol does not come with a way to authenticate a domain and, during an SMTP session, nothing really prevents a sender from pretending to come from any domain:</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2018-01-08/news-from-the-front/><h3 class="text-lg font-semibold mb-0.5">News from the front !</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: Came very close to a burn out late 2016, had to quit former employer. Started working at another company early 2017. Became a student again, currently halfway through second year in psychology. Haven't done much opensource since early 2017, slowly resuming. Happy new year ! I wish you a very happy new year 2018 and hope that you succeed in whatever you attempt.
It feels odd to write again to this blog considering the last blog post dates from September 2016, over a year ago.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2016-09-12/opensmtpd-6.0.0-is-released/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD 6.0.0 is released !</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: We just released OpenSMTPD 6.0.0 and it's quite different from former releases. Turns out most of the changes are not visible. A featureless release I managed to wrap the 6.0.0 release yesterday.
Unlike most of our releases, it comes out with almost no new feature.
The changelog fits in less than 10 lines as follows:
- new fork+reexec model so each process has its own randomized memory space - logging format has been reworked - a "multi-line response" bug in the LMTP delivery backend has been fixed - connections concurrency limits have been bumped - artificial delaying in remote sessions have been reduced - dhparams option has been removed - dhe option has been added, supporting auto and legacy modes - smtp engine has been simplified - various cosmethic changes, code cleanup and documentation improvement Seems like a very productive slacking, however some of these changes turn out to be very interesting in terms of code simplification and security.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2015-12-22/home-sweet-home/><h3 class="text-lg font-semibold mb-0.5">Home, sweet home</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: OpenSMTPD on github no longer diverges from OpenBSD. Since last episode Sometime this year, we released OpenSMTPD 5.7.1 which was the first version that shipped with the long-awaited experimental filters support. The result of over a year and a half of very very deep refactor in our IO layer and the addition of a very elegant but also very tricky new API.
This refactor took place outside the OpenBSD tree because it required breaking a lot of code for extended period of times, which spanned over 3 OpenBSD releases.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2014-12-12/the-state-of-filters/><h3 class="text-lg font-semibold mb-0.5">The state of filters</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">TL;DR: yeeeees, filters are coming. don't believe us ? here's an example. be patient. On my death bed On my death bed, when my life flashes before my eyes and I start recalling what people have told me during my (hopefully long) lifetime, these sentences will single out:
&ldquo;When will OpenSMTPD support filters ? I need it.&rdquo;
Not that it carries a philosophical meaning that will have taken me a lifetime of thinking, but because for the last three years I have been hearing this every time I met someone IRL and discussed OpenSMTPD, I have read it on our Github issues tracker, on GTalk, on IRC, on Twitter, on Facebook, on random forums, and just this week three times in my mailbox.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2014-12-10/some-opensmtpd-overview-part-3/><h3 class="text-lg font-semibold mb-0.5">Some OpenSMTPD overview, part 3</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">EHLO,
This is the third post of a series about OpenSMTPD improvements that have taken place since this summer.
Content altering For a long time, we have developed OpenSMTPD with a strict rule that the daemon should not alter DATA (as in the DATA SMTP phase) in any way.
The rationale was that by enforcing that rule, the message writing was simplified as the smtp process would simply read data from a client and write it, without any post-processing, to a file descriptor.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2014-12-01/some-opensmtpd-overview-part-2/><h3 class="text-lg font-semibold mb-0.5">Some OpenSMTPD overview, part 2</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">Why we killed the MFA (filter) process For as long as I can remember, a process called MFA was created by OpenSMTPD at start time.
MFA stood for &ldquo;Mail Filter Agent&rdquo; and the goal of that process was initially to take care of all filtering tasks ranging from filtering senders based on the ruleset matching to starting and controlling filters.
As time passed by, we figured the lookup process was better suited for ruleset matching and the MFA process became mostly idle, we renamed it to &ldquo;filter&rdquo; process since the only thing it had to do was take care of starting filters and making sure they had the proper environment.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2014-11-26/some-opensmtpd-overview-part-1/><h3 class="text-lg font-semibold mb-0.5">Some OpenSMTPD overview, part 1</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">EHLO world ! Yesterday I thought I&rsquo;d write a first OpenSMTPD-related post to sum up the changes that have happened since this summer but it turned out to be painful as they amount to quite a lot. Instead, I think a better strategy is to split this into a serie of smaller posts focused on the specific changes ;-)
So, in June I have organized a mini hackathon at my brand new place and invited some of the French Connection at home.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2014-11-24/what-the-fsck-did-just-happen/><h3 class="text-lg font-semibold mb-0.5">what the fsck did just happen</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">Good news everyone !
With last post dating from almost a year, we can all agree that I&rsquo;ve outpassed my slacking skills by a great margin and I probably deserve an award of some kind ;-)
Anyways, there&rsquo;s been a few complaints during these 12 months because this blog was the main source of information for the OpenSMTPD project and several posts which used to describe features and configuration samples had suddenly disappeared.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2013-12-14/news-from-the-front/><h3 class="text-lg font-semibold mb-0.5">News-from-the-front</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">EHLO readers,
This blog post is the first since a few months, I&rsquo;ve been busy and struggling with some personal health and familial issues. I won&rsquo;t share them here as its not really something anyone can help with, so&mldr; let&rsquo;s focus on OpenSMTPD !
What happened since last post
When I wrote the last blog post, we had just released 5.3.2 which was a minor release that fixed a few non-critical bugs that were reported to us since the first major release a few months earlier.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2013-12-14/opensmtpd-improvements-summary/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD improvements summary</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">Hey,
No OpenSMTPD news since almost a month&mldr; time to break the trend !
As far as I&rsquo;m concerned, I&rsquo;ve been busy with other work but still a git log shows that between Eric and I we have accumulated quite a few things during this month. Below is a short non-exhaustive summary of changes and news.
All of it is already pushed to our Github mirror and part of the snapshots that were published yesterday.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2013-05-08/installer-openbsd-sur-une-dedibox-classic-gen2/><h3 class="text-lg font-semibold mb-0.5">Installer OpenBSD sur une dedibox Classic+ Gen2</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">Yop,
Les services de poolp.org sont hébergés sur plusieurs serveurs.
Le serveur principal à été basculé d&rsquo;un petit hébergeur US &ldquo;OpenBSD-friendly&rdquo; vers Online.net depuis 3 ans maintenant. J&rsquo;ai rusé à l&rsquo;époque pour installer OpenBSD sur la Dedibox &ldquo;DC&rdquo; en utilisant une vieille version de Yaifo et en faisant des upgrades successives du système d&rsquo;exploitation. Mis à part 3 petits downtimes dont 1 de ma responsabilité, je n&rsquo;ai jamais eu à me plaindre de leurs services et de leur matériel.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2013-04-26/opensmtpd-table_proc-queue_proc-crypto-queue-and-other-stuff/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD: table_proc, queue_proc, crypto queue and other stuff</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">Yop,
This week has been very productive with several tickets closed and more about to be closed.
Eric has done an amazing work as you will soon realize ;-)
I will push to our Github mirror and publish a snapshot this week-end very likely, until then don&rsquo;t look for the features, only we have them !
Compressed and Encrypted queue
While working on bringing back encrypted queue support, I ran into a couple issues.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2013-04-21/news-from-the-front/><h3 class="text-lg font-semibold mb-0.5">News from the front</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">OHAI,
I have not updated this blog since the release of OpenSMTPD 5.3, over a month ago. In the meantime, some minor bugs have been fixed and we have released OpenSMTPD 5.3.1.
The main reason for the silence is that I was busy with completely unrelated day-time work, unrelated opensource code, the OpenSMTPD book in progress and some minor health issues that have caused endless side-effects keeping my mind away from this blog.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2013-03-17/opensmtpd-5.3-released/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD 5.3 released</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">OHAI !
I&rsquo;ve stayed silent for the last month as we got ready for the big thing&mldr;
Charles, Eric and I are proud to announce the release of OpenSMTPD 5.3, our first official production-ready release !
OpenSMTPD has been in use at poolp.org since 2008 and these last five years have seen a considerable amount of work. At various times we have been contemplating a release then delaying to add that one thing that seemed essential.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2013-02-02/opensmtpd-minor-fixes--preparing-release/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD: minor fixes + preparing release</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">OHAI,
We had planned to slow down a bit to prepare for release: no more feature, no more invasive changes until we tag something out of which we can publish a release. I then discussed with Bret Lambert (blambert@) and he asked me if we used some kind of code scanner to detect defects in our code.
We do use the clang static analyzer every now and then, the last time being a couple week ago, and we spend a few minutes cleaning up the defects we believe to be real issues.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2013-01-25/opensmtpd-gentlemen-fasten-your-seatbelt/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD: gentlemen, fasten your seatbelt</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">OHAI,
Lately we have stabilized and decided that we&rsquo;re okay with the features we have for our first release, this time for good, so we focused on making sure that we didn&rsquo;t introduce regressions and that we were rock solid.
We stressed incoming and outgoing path and found areas of improvements. This will be a long-standing task, but we have already improved memory usage considerably under high-load, we&rsquo;re pretty happy with the result.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2013-01-18/opensmtpd-stress-and-features/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD: stress and features</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">&lt;p>Hey,&lt;/p> I wanted to publish something last Friday but I unfortunately got my hands on a copy of Super Nintendo's Zelda which led to an instant loss of motivation.
Here's a quick summary of what happened recently in OpenSMTPD-land, it's not an exhaustive description and to be honest I'm keeping a lot of information private at this point and probably until release ;-)
A snapshot should be published tomorrow.
Stressing the daemon</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2013-01-08/welcome-to-you-2013/><h3 class="text-lg font-semibold mb-0.5">Welcome to you, 2013</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">YO!
I know I should have posted a &ldquo;Happy New Year&rdquo; note earlier but you know how it is: new year eve&rsquo;s aftermath, days to recover, work resumes, mood slacks, bleh.
Anyway, today&rsquo;s note is simply about that: wishing you and me an awesome year 2013 and hoping you will not turn it into a fucking mess. After all, you&rsquo;re in charge so we know who to blame ;-)
As far as I&rsquo;m concerned, year 2012 wasn&rsquo;t &ldquo;great&rdquo;, it was not the absolute suck either, it was even quite decent.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2012-12-28/opensmtpd-ssl-relay-stuff/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD: SSL & relay stuff</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">OHAI,
I was unable to write a story last week as my desk broke into pieces for no apparent reason but my foot hitting it accidentally.
I still don&rsquo;t have a desk so I will make this short by not telling about the queue profiling and SQL log conversion I wrote, and not even writing about the filter work done by Eric, he&rsquo;ll write about it if he wants to or I&rsquo;ll do that next time.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2012-12-14/opensmtpd-ldap-support-selectable-source-dkim-and-goodies/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD: LDAP support, selectable source, DKIM and Goodies</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">&lt;p>OHAI,&lt;/p> This week has been crazy, my brain melted a little as I worked on filters, it melted a little as I worked on LDAP and it melted a little more as I tried to trick Eric into working on filters with me (yes, that actually worked :-).
Anyway, as usual, this is just going to be a summary of what we did as tons of little stuff have been committed here and there.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2012-12-07/opensmtpd-fully-virtual-setups-updated-dns-mta-code-sqlite-support/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD: fully virtual setups, updated DNS & MTA code, SQLite support</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">OHAI,
This week I had intended to work on filters. After 3 days of pain and swearing, even though it did move forward, I finally decided to step back for a few days and work on something else to preserve my sanity.
As you may have guessed, this week has not been too productive&mldr; Oh wait, yes it has ! It&rsquo;s actually been incredibly productive :-)
Just as usual, I will only write a summary for this week, the complete changelog can be retrieved from our mirror on Github.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2012-11-30/opensmtpd-more-features-more-cleanup-more-more/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD: more features, more cleanup, more more</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">OHAI,
First of all, on a completely unrelated note, I&rsquo;d like to emphasize that this blog post is being written from my text editor launched by a little shell and pushed to poolp using the Ocean API. I can be web2.0 from console and emacs, and that&rsquo;s definitely worth a mention ;-)
As has become a habit, a lot of work has been poured in OpenSMTPD this week, here is an incomplete summary of the most notable changes.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2012-11-17/news-from-the-front/><h3 class="text-lg font-semibold mb-0.5">News from the front</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">Almost a month since my last post&mldr; I know, I know.
So I left my position at Scality two weeks ago. I had been there for a year and a half working on a very interesting and tricky project. I will miss my colleagues and the discussions we had on all kinds of topic, I hope them the best future and that we will be able to share beers again ;-)</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2012-08-31/opensmtpd-crypto/compress-fixes-and-import-initial-stab-at-ldap/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD: crypto/compress fixes and import initial stab at LDAP</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">The crypto backend that has been committed a couple days ago started a little discussion and it was decided to switch the default cipher from Blowfish to AES-128 and make it a default.
Encryption can now be enabled as simply as:
queue encryption key &ldquo;foobar&rdquo;
That being said, Charles cleaned up a bit the compression code to make it use FILE* instead of file descriptors. This allows us to ensure we don&rsquo;t have to deal with any buffering and interruption handling code.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2012-08-29/opensmtpd-crypto_backend-and-encrypted-queue/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD: crypto_backend and encrypted queue</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">A few days ago, Charles committed the compress_backend API which allowed transparent deflation/inflation of envelopes and messages as they hit the queue.
The compression code is executed before the queue_backend gets the data so that any queue_backend can benefit transparently from compression without having to add any code to handle it. Due to our design, this also means that if the queue_backend stores envelopes and messages remotely, then the compression will take place before sending and after fetching, the remote end only ever sees compressed data.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2012-08-26/opensmtpd-i-have-no-idea-for-that-title-sorry/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD: I have no idea for that title, sorry</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">Howdie,
Eric and I had planned a loooooong time ago to have a hackathon this week-end. However, some asshole piece of shit ran into my car while it was parked, made it unable to take the road and flee without leaving a note. Long story made short, I had to be at the repair shop this week-end to be able to get my car before end of September.
We did get our hackathon though and while it was probably much less productive than if we had met in the same room, it was still very very interesting with tons of improvements and many great features written :-p</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2012-08-21/opensmtpd-plenty-of-news/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD: plenty of news</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">It&rsquo;s been over a month since my last post but I have an excuse: I was super busy, then I was super on vacation &mldr; but I&rsquo;m back again ;-)
So my life was pretty intense these last few weeks, both professionnally and on the opensource front. I&rsquo;ll explain later, for now let&rsquo;s just focus on the OpenSMTPD goodies.
OpenSMTPD portable to a new system First of all, I&rsquo;d like to stress out that Rune Lynge and Charles Longeau did an amazing job at porting OpenSMTPD to yet another system &mldr; MacOSX.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2012-07-15/g2k12-openbsd-hackathon-part-ii/><h3 class="text-lg font-semibold mb-0.5">g2k12: OpenBSD hackathon - part II</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">Yesterday, I came back from Budapest and was too tired to write anything, but here&rsquo;s a quick summary of all the features that have been implemented with regard to OpenSMTPD by Eric, Charles and I.
First of all, Eric [eric@] has moved ASR, his asynchronous resolver, to OpenBSD&rsquo;s libc. This is a huge step forward that will allow OpenSMTPD to contain less code, while providing a better coverage of the resolver code.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2012-07-09/g2k12-openbsd-hackathon/><h3 class="text-lg font-semibold mb-0.5">g2k12: OpenBSD hackathon</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">Yesterday, after nearly missing my plane by 5 minutes, I finally managed to make it to Budapest for g2k12, the OpenBSD general hackathon.
While this is not my first hackathon, this is the first general one with many hackers working on all kinds of subsystems ranging from ports to network and kernel. It&rsquo;s fun to see many people focused on improving different areas which you use daily, sometimes without even noticing, and doing it with as much fun as you are having fixing your own area ;-)</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2012-06-19/opensmtpd-development-bug-tracker-github/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD: development, bug tracker & GitHub</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">It&rsquo;s been a while since my last post about OpenSMTPD.
I don&rsquo;t know what Eric and Charles have been up to, I was quite busy with my daytime job and couldn&rsquo;t really spend much time on the hobby ;-)
Anyways, one of the most requested feature of OpenSMTPD is to provide users with a mean to report bugs and let them contribute more easily. It&rsquo;s been requested two times this week, it&rsquo;s been requested countless times in the last few weeks and months, and as a matter of fact it&rsquo;s also been a nuisance for us as until now we&rsquo;ve kept track of bugs and feature requests in my mailbox.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2012-06-06/opensmtpd-rest-queue/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD REST queue</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">This is the first post of a series to illustrate and describe a &ldquo;proof of concept&rdquo; code by Charles, Eric and I. I will describe the features as they are implemented.
Since mid-November 2011, OpenSMTPD offers support for an extensible queue API. The queue_backend API allows a developer to write a custom storage driver by implementing a small set of functions that take care of storing, updating and removing envelopes and messages.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2012-05-17/opensmtpd-src-address-maps-and-spamhaus/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD: src-address maps and spamhaus</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">First of all, I&rsquo;d like to &ldquo;thank&rdquo; The Spamhaus project which forced me into hacking this feature in a hurry.
See, I rent a server at online.net which I use for OpenSMTPD live testing and to run some experimental code before it hits the OpenBSD tree.
Yesterday I received a mail from a user complaining that he couldn&rsquo;t send mail to a friend because we were listed on spamhaus. That was very strange because ALL users at poolp.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2012-05-14/opensmtpd-relay-maps-new-url-syntax/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD relay maps & new url syntax</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">When we first started working on OpenSMTPD, we planned for future features but we did not necessarily start integrating them right away as the goal was to bootstrap the project first with basic features.
Amongst these features was the ability to use mappings for outgoing MX servers. Currently, OpenSMTPD knows two ways of going out:
Using the DNS system to find MX records: accept for [&mldr;] relay
Using the provided mail exchanger: accept for [&mldr;] relay via &ldquo;my-mx.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2012-05-13/opensmtpd-map_compare-and-k_netaddr/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD, map_compare() and K_NETADDR</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">Ok, I already posted about the new SQLite map_backend earlier today but it turns out that I&rsquo;ve been very productive, and it was worth another post ;-)
So I decided to start improving our maps support and make them usable from places where they weren&rsquo;t.
primary domains
OpenSMTPD supports two kinds of domains: primary domains and virtual domains. The primary domains do not require providing a list of recipients as it will use system accounts; whereas virtual domains require a list of recipients and/or a fallback address to be provided within a map.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2012-05-12/opensmtpd-meets-sqlite/><h3 class="text-lg font-semibold mb-0.5">OpenSMTPD meets SQLite</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">During the r2k12 hackathon in Paris, Marc Espie committed SQLite to OpenBSD&rsquo;s base system.
This has the side effect that OpenSMTPD can start using it and while we agreed that we did not want it as a strong dependency, the various backends API allow us to make it a soft dependency that can be removed without breaking the daemon if someone really does not want SQLite linked.
Today I decided to give it a try and implement a SQLite backend to the map API.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2012-05-09/some-opensmtpd-news/><h3 class="text-lg font-semibold mb-0.5">Some OpenSMTPD news</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">It&rsquo;s been a whiiiiiiile since my last OpenSMTPD related post. Time to break the slacking, blog-wise.
Unlike what would appear from the outside, there&rsquo;s been a lot of activity, discussions and planning, I&rsquo;ll address some here and will discuss it further soon.
First of all, chl@ has committed to a private branch a major improvement to the filter API: async DNS lookups. Due to the design of OpenSMTPD, it is not acceptable for a filter to perform a blocking call as it will prevent it from processing other sessions.</div></a><a class="article block px-3 py-4 hover:bg-slate-200 dark:hover:bg-slate-700" href=/posts/2005-05-21/fatigue-et-envie-de-vacances.../><h3 class="text-lg font-semibold mb-0.5">fatigue et envie de vacances...</h3><div class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2">Je sais pas pourquoi, mais je suis epuise alors que j&rsquo;ai dormi pres de 14h cette nuit. J&rsquo;ai envie de faire une pause, de me prendre une annee de vacances au bord de la plage les doigts de pieds dans le sable fin blanc pendant qu&rsquo;on me sert du sorbet a la noix de coco sur fond de Gojira alors que le soleil me rechauffe le visage mais juste un peu, pas trop, voila, comme ca, merci.</div></a></div></section><div class="overflow-y-auto h-screen w-full"><article class="px-6 py-20 w-full mx-auto prose lg:prose-lg h-fit dark:prose-invert prose-img:mx-auto"><h1 class=!mb-2>June 2019 report: fion, bpg and smtpd</h1><p class="text-sm text-slate-500 !mb-8">Planted June 30, 2019
by
<a href=#>Gilles Chehade</a></p><pre><code>TL;DR:
- started working on FION, a static tile window manager
- revived BPG, a PGP parser
- converted OpenSMTPD to libtls
- wrote a library to make writing of native C OpenSMTPD filters easy
- started writing a filter-rspamd
</code></pre><h2 id=thanks-to-my-patrons->Thanks to my patrons !</h2><p>First of all,
a huge thanks to my first patrons:</p><ul><li>Bleader Raton</li><li>Diego Meseguer</li><li>Mischa Peters</li><li>Vegar Linge Halaand</li></ul><p>I have recently switched to a 75% part-time schedule at work so that I can spend
a &ldquo;free&rdquo; week each month working on my own stuff, mostly opensource, without any
kind of pressure: no one knows what I&rsquo;ll be working on and no one but me gets to
decide how I&rsquo;ll spend this time.</p><p>This comes at the cost of slashing a quarter of my wage, which is sustainable but
not ideal, so while most of my &ldquo;free&rdquo; weeks will be spent on opensource, I&rsquo;ll be
doing some sponsored development or short contracts to cover some of the loss if
needed.</p><p>I opened a patreon account so that people who care about my work can sponsor it,
allowing me to spend most (if not all) of these &ldquo;free&rdquo; weeks publishing code for
the community. If you want me to spend more time doing this then you know what
to do: <a href=https://www.patreon.com/gilles target=_blank rel=noopener>become my patron</a> !</p><p>So thanks again to my patrons who make this possible, I will list them in all of
my monthly reports, they are the sponsors of the work I describe below.</p><h2 id=fion-a-featureless-ion>FION: a featureless ion</h2><p>I&rsquo;m not too much of a graphical interface person,
so when I was shown the ion window manager in 2003 I became addicted and,
ever since,
it&rsquo;s been very hard for me to work efficiently using anything else.
This is not an elitist thing,
it is really me being easily distracted by stuff like windows not being properly
aligned and similar stupid concerns that actually slow me considerably.
I call this the &ldquo;oh-a-butterfy&rdquo; effect.</p><p>Unfortunately,
the last ion release dates from 2009 and is unmaintained.
This leads to multiple problems,
one being the lack of modern features, like multi-screen, which is essential for
me considering the amount of time I spend reading code and specs side-to-side.
Another problem is the fact that it&rsquo;s been removed from most repositories, and I
keep having to build it from source here and there.
Recently it&rsquo;s been a bit more difficult because on some distro,
the dependencies for ion were no longer available and I had to start patching it
here and there so it could build.</p><p>I fear the day this happens on OpenBSD because it will mean that I have to spend
time maintaining a piece of code for which there&rsquo;s no upstream anymore &mldr; or be
back to working partly in console, partly in a maximized tmux when I really need
a browser visible.</p><p>I know this will lead people to tell me &ldquo;but there&rsquo;s notion, ion&rsquo;s fork&rdquo; or &ldquo;but
you can use awesome/dwm/i3/wmii/<insert yours here>&rdquo; but honestly I have tried a
lot of different window managers along the years to try getting away from ion as
it was abandoned and they never quite fit for me. I can only work if I have a wm
that does tabs within static tiles that I can h-split/v-split at will and resize
however I want. Notion came short because at least on OpenBSD it was laggy.</p><p>I might as well spend a few hours / days working on my own, learn how they work,
and release something I&rsquo;m willing to maintain on the long run as it scratches my
own itches.</p><h2 id=fions-feature>FION&rsquo;s feature</h2><p>I didn&rsquo;t care that much for many of ion&rsquo;s feature, never used the lua binding or
the floating workspaces.</p><p>FION will simply implement what I intend to use, so at the time being, this is:</p><ul><li>pledge()-ed</li><li>multiple screens of different sizes</li><li>multiple workspaces per screen</li><li>workspaces may be split in multiple horizontal and vertical tiles</li><li>each tile may hold multiple X clients in tabs</li><li>tiles may be resized</li><li>screens / workspaces / tiles / tabs may be controlled through keyboard</li></ul><p>As of today, I&rsquo;d say I&rsquo;m halfway through, FION will detect screens and setup the
workspaces to match screen size. It can create as many workspaces as you want on
every single screen. It can h-split and v-split as many tiles as you want on the
current workspace. It can iterate through workspaces and tiles. It can start the
X clients and attach them, properly sized, to the current tile. It can give the
focus to a tile through keyboard-triggered iteration of tiles or by moving mouse
over a tile.</p><p>Can you try it yet ? nope.</p><p>FION currently does not have the logic to remove tiles, you can create and split
but not kill tiles, which is not hard to do but I just ran of time this week ;-)</p><p>Also, keyboard events are not properly handled yet so I had to map features to a
simple key like &rsquo;n&rsquo; or &lsquo;p&rsquo; to test them. Until I have more time for figuring out
how I can implement my keyboard shortcuts so that they use control sequences, it
will not be usable for daily use.</p><p>Code is already committed on Github but again &mldr; not usable, so stay tuned, the
first usable version will be announced on <a href=https://twitter.com/poolpOrg target=_blank rel=noopener>twitter</a>
when it&rsquo;s available.</p><h2 id=obligatory-screenshots>Obligatory screenshots</h2><p>I must have spent about six hours worth of work on it and the result is quite ok
so I have good hope (no promise !) to make a first beta release during my &ldquo;free&rdquo;
week in July.</p><p>Here are a couple screenshots:</p><p>FION ran on my laptop a few days ago before X clients were resized to match tiles:</p><img alt="FION on my laptop screen" src=2019-06-30-fion_1.png width=100%>
[full screen](2019-06-30-fion_1.png)<p>FION ran on a bigger screen this morning:</p><img alt="FION on my 3440x1440 screen" src=2019-06-30-fion_2.png width=100%>
[full screen](2019-06-30-fion_2.png)<p>And because a project doesn&rsquo;t exist until it has a logo:</p><img alt="FION logo" src=2019-06-30-fion_logo.jpg width=100%>
[full screen](2019-06-30-fion_logo.jpg)<h2 id=bpg-bsd-privacy-guard>BPG: BSD Privacy Guard</h2><p>While looking at old private repositories to decide if I should axe them or not,
I ran into an interesting one: bpg.</p><p>Long story short,
while I was a student in 2002 or 2003,
I was doing night shifts at a security company to monitor firewalls and since it
was essentially a passive job because I had nothing to do until the screens went
all red, I started working on BPG a BSD-licensed PGP implementation.</p><p>Then, NetBSD came up with a similar project for a Google Summer of code and they
had someone already working on it, so I gave up as I had only a few weekly hours
available for this and my work would surely be less good than someone working on
it full-time for NetBSD.</p><p>Anyways,
I spent a while looking at the code to see what could be done with it, and it is
actually not bad at all.</p><p>I have a parser that can read all PGP packets in both old & new format, map them
to appropriate structures that can actually be used: it can essentially read the
keyrings and packets generated from gpg2, though it will not decrypt/verify.</p><p>The parser code was quite clean and I didn&rsquo;t make changes to it except remove an
allocator to replace it with <code>malloc_conceal(3)</code>. I did a bit of code cleanup on
other parts, like armoring which was ugly, but that&rsquo;s about it.</p><p>I don&rsquo;t know what to do about that code, I have no idea how usable is the NetBSD
implementation and how interesting it is for people to have another PGP utility.
I will release the parser for sure since the code is already here and maybe it&rsquo;s
going to be useful to someone but I&rsquo;m unsure if I should move project forward at
this point. Oh and I need a new name anyways because bpg is already taken and it
is certainly not going to be OpenBPG to avoid confusion with OpenBGP :-)</p><p>I have quickly written code to generate RSA keypairs just for fun:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>laptop$ bpg key gen rsa <span style=color:#bd93f9>2048</span> &gt; /tmp/rsa2048.bpg
</span></span><span style=display:flex><span>..........................................+++...................+++.
</span></span><span style=display:flex><span>laptop$ bpg debug parse /tmp/rsa2048.bpg
</span></span><span style=display:flex><span><span style=color:#6272a4>## 05 : New format Secret-Key packet (920 bytes)</span>
</span></span><span style=display:flex><span>        version: <span style=color:#bd93f9>4</span>
</span></span><span style=display:flex><span>        algorithm: RSA <span style=color:#ff79c6>(</span>encrypt or sign<span style=color:#ff79c6>)</span>
</span></span><span style=display:flex><span>        keyid: e60e44654c3409be
</span></span><span style=display:flex><span>        fingerprint: 7bfd297855a9c0d22a492ba2e60e44654c3409be
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4>## 0d : New format User ID packet (16 bytes)</span>
</span></span><span style=display:flex><span>        content: test@example.com
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>laptop$ cat /tmp/rsa2048.bpg
</span></span><span style=display:flex><span>-----BEGIN PGP PRIVATE KEY BLOCK-----
</span></span><span style=display:flex><span>Version: BPG v0.1 <span style=color:#ff79c6>(</span>OpenBSD<span style=color:#ff79c6>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>xcLYBF0YccABCACzay1zxLQzD9WvOaF5DZXKIx5nmwP70+ff4XceepFnylwe7iKzTUF6W4kv
</span></span><span style=display:flex><span>QxOF++z9SQ5mF0melyj0+TkJXUSs7MzNjuwb4OhDLiM9uVJ2J1wxA3KivY0pVjvJPtPTlMpZ
</span></span><span style=display:flex><span>D7Ebb1CnagP75DEcgpdzWHDSzBbgHN89ct6M7fPZ756iDxHdnhO8syr9sB4GOJyj8hC2dC4y
</span></span><span style=display:flex><span>qJvn7G7/BdQwDov23FUGcddWXIyPMs4GGbE+mpV1U6jqZbNUkGPl+Kh8CfRU15D2/60PsrgD
</span></span><span style=display:flex><span>3OSDo3J/DwGd2/NiVRRWVSOOtpzm4sc4j1J76nwrUJvvWRlH+AMOfDxoDu03bY2Jb/NtABEB
</span></span><span style=display:flex><span>AAEAB/9Pw8ZhQYIbcV6+mBCBkNiXFSXfSbtrqbncfpBGrJcYXY628YfbzuzdSPSkXl2/o1Cp
</span></span><span style=display:flex><span>CmGsYY4JQ4qh3mrNDvoJJv2mJXQysLqRo2Fnf4x5muYRpEbCsyKezgemYJgr6GpNTfyfBc4F
</span></span><span style=display:flex><span>n8xFoB11X1mVniwKi1FgMXXOC9OFNATFTlK2EjiBCBN1g+AbO31ykqDyhuVjAisQXlrpvRSr
</span></span><span style=display:flex><span>Jlk3zwNDgyu8jd9NyqCj3wUbp5GTj9/N+JVqm4lxqRAXUJk804w9q4Vn1x5f+lxyOw70m6vV
</span></span><span style=display:flex><span>9xKZqKB/g2CmqFNVn8nzparvZQ45FSwKFkCz8Z0XrCJG8HvxkS0fBewu2BLBBADvAzcqblpX
</span></span><span style=display:flex><span>9ygSDsOF/JDt9nhduLcVDgFzOagfZvh9eAny0YGQZ7rue2Vd3DKbMRBkybpn3jKpRbJC8+96
</span></span><span style=display:flex><span>6AVaaxtoaHt7jKxZMHdjlxRPe6f9rFqETgL4a0+xyGzGd72t2OZG9pXNbydrwJPo0PSybkvR
</span></span><span style=display:flex><span>hkyd7vP3886X1EkdrwQAwCupzj3qSKf06ATAy+31rKoIUgsHD7OuyrNl7I1FZIMWNttaEl1C
</span></span><span style=display:flex><span>Z0bYaKHaTZbtoNk9EsISxSIXf3HB7nisKmGDe+LfXD06q9Bk1Tpjoj+zMXhJAm/NOQfbWXgJ
</span></span><span style=display:flex><span>3/1b6EbI63o1JcBlZDXbrGv5IOY+c7gZqbOc3hD8EThHA6MD/0fQC4TuqH9nkJVyiDp0G+48
</span></span><span style=display:flex><span>nq2oFDiDEfJ58TiSFlws/K+nuy2uGGO91iJLA6go5B87b0ihvl6A1Z4XFXuopRMcVp87n9gH
</span></span><span style=display:flex><span>qqRLhvoBqhMdVlfPnYr8JZYu0HkzmFtCnwuQOIA8EH8FQ65ImrP5PopazIHiUwhunrTzoAWp
</span></span><span style=display:flex><span>/4JOulbNEHRlc3RAZXhhbXBsZS5jb20<span style=color:#ff79c6>=</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>=</span>0fuz
</span></span><span style=display:flex><span>-----END PGP PRIVATE KEY BLOCK-----
</span></span><span style=display:flex><span>laptop$
</span></span></code></pre></div><p>They are not valid, generating a valid key that can be imported to
gnupg requires adding a signature packet which means I have to write the
signing code to do that.</p><p>So there we go, either the project ends up as a PGP parsing library that others
may use freely in their PGP implementations or it can evolve into a PGP library
and utility, it depends on how needed and wanted this is by the community.</p><p>I will commit what I have during July.</p><h2 id=opensmtpd>OpenSMTPD:</h2><p>What should come as no surprise: I spent most my week working on OpenSMTPD.</p><p>I have tackled two topics:</p><ul><li>migration from the OpenSSL to the libtls API for TLS support</li><li>filters</li></ul><h2 id=opensmtpd-openssl---libtls-migration>OpenSMTPD: OpenSSL -> libtls migration</h2><p>I have started working on the migration from the OpenSSL API to the libtls API
for TLS support in OpenSMTPD.</p><p>And by &ldquo;I have started&rdquo;, I really mean &ldquo;I&rsquo;m almost done&rdquo;.</p><p>The server side is mostly finished as I just need to rewrite the SNI support
in a slightly different way. The client side is also mostly finished but needs a
bit of cleanup.</p><p>This wasn&rsquo;t as straightforward as I thought it would be, mostly due to the fact
that OpenSMTPD uses a low-level &ldquo;io&rdquo; API for all its network io and that it was
tricky to work on a progressive migration. I eventually found a way that allowed
me to migrate the client-side first, then focus on the server-side, then use
solely libtls. When this will be committed to OpenBSD, it will have to be an
atomic switch, I won&rsquo;t be able to progressively bring server and client side
migrations.</p><p>I also ran into some issues that were not easy to tackle, like the fact that we
used ex data in RSA / EC_KEY objects to pass pki name to the privsep crypto
engine for key lookups &mldr; but libtls already used ex data to pass a checksum.
I could have worked-around but it made sense leaving the checksum in ex data,
as it&rsquo;ll be useful in the future, so a bit of refactoring was require here and
there.</p><p>So libtls-enabled OpenSMTPD is now a thing,
when its finally commited I&rsquo;ll be able to close multiple feature-requests that
will be trivial to implement or already solved by sife-effect of the mgiration.</p><p><strong>Does this mean OpenSMTPD will become LibreSSL only ?</strong></p><p>NOPE.
This means that instead of having OpenSMTPD detect and deal with the differences
between OpenSSL and LibreSSL as well as different OpenSSL versions, it will just
depend on the libtls interface. We can then work on having a portable libtls for
use as a wrapper around OpenSSL. This will then solve the LibreSSL vs OpenSSL vs
different versions of OpenSSL issue for good.</p><h2 id=opensmtpd-filters>OpenSMTPD: Filters</h2><p>I have resumed working on filters and this resulted in a few interesting bits.</p><h2 id=timestamps-in-filter-events>timestamps in filter events</h2><p>Until now,
filter events reported the time at which an event was generated using a time_t
unix timestamp accounting seconds since epoch.</p><p>I had already converted reporting events to use a timeval for sub-second precision,
so I also converted filter events to use a timeval too.</p><h2 id=filter-strderr-mapped-to-log_warn>filter strderr mapped to <code>log_warn()</code></h2><p>I okayed a diff from <code>martijn@</code> to map the <code>stderr</code> file-descriptor in filters to
an endpoint in smtpd which logs all input with <code>log_warn()</code>.</p><p>This means that a filter calling <code>warnx()</code> or a shell script doing an <code>echo bleh >&amp;2</code> will be logged in <code>maillog</code>,
making it simpler to see output during development and in case of issues in production.</p><h2 id=filter-eventlog>filter-eventlog</h2><p>I have committed to github my first native filter, <code>filter-eventlog</code> which is a
filter written in C that reports ALL smtp-in events to an append-only file, and
creating a new file every day to hold the events of the day.</p><p>This is useful for filter developers as it allows them to check what events are
generated by the daemon and which ones they should listen to in their filters.</p><p>With the lines below in your config:</p><pre tabindex=0><code>[...]

filter mylogs proc-exec &#34;/usr/libexec/filter-eventlog /tmp/logs&#34;

listen on socket filter mylogs

[...]
</code></pre><p>Sending a mail will result in the following being written to files within /tmp/logs:</p><pre tabindex=0><code>report|1|1561888072.457091|smtp-in|link-connect|d812eceafa0ae39e|laptop.home|pass|local:0|local:0
report|1|1561888072.457781|smtp-in|filter-response|d812eceafa0ae39e|connected|proceed
report|1|1561888072.457800|smtp-in|protocol-server|d812eceafa0ae39e|220 laptop.home ESMTP OpenSMTPD
report|1|1561888072.458290|smtp-in|protocol-client|d812eceafa0ae39e|EHLO localhost
report|1|1561888072.458773|smtp-in|filter-response|d812eceafa0ae39e|ehlo|proceed
report|1|1561888072.458778|smtp-in|link-identify|d812eceafa0ae39e|localhost
report|1|1561888072.458784|smtp-in|protocol-server|d812eceafa0ae39e|250-laptop.home Hello localhost [local], pleased to meet you
report|1|1561888072.458787|smtp-in|protocol-server|d812eceafa0ae39e|250-8BITMIME
report|1|1561888072.458790|smtp-in|protocol-server|d812eceafa0ae39e|250-ENHANCEDSTATUSCODES
report|1|1561888072.458794|smtp-in|protocol-server|d812eceafa0ae39e|250-SIZE 36700160
report|1|1561888072.458797|smtp-in|protocol-server|d812eceafa0ae39e|250-DSN
report|1|1561888072.458800|smtp-in|protocol-server|d812eceafa0ae39e|250 HELP
report|1|1561888072.459268|smtp-in|protocol-client|d812eceafa0ae39e|MAIL FROM:&lt;gilles@laptop.home&gt;
report|1|1561888072.459718|smtp-in|filter-response|d812eceafa0ae39e|mail-from|proceed
report|1|1561888072.460764|smtp-in|tx-begin|d812eceafa0ae39e|754cbaa4
report|1|1561888072.460770|smtp-in|tx-mail|d812eceafa0ae39e|754cbaa4|&lt;gilles@laptop.home&gt;  |ok
report|1|1561888072.460774|smtp-in|protocol-server|d812eceafa0ae39e|250 2.0.0: Ok
report|1|1561888072.460995|smtp-in|protocol-client|d812eceafa0ae39e|RCPT TO:&lt;gilles@laptop.home&gt;
report|1|1561888072.461131|smtp-in|filter-response|d812eceafa0ae39e|rcpt-to|proceed
report|1|1561888072.462172|smtp-in|tx-envelope|d812eceafa0ae39e|754cbaa4|754cbaa41a1afada
report|1|1561888072.462180|smtp-in|tx-rcpt|d812eceafa0ae39e|754cbaa4|&lt;gilles@laptop.home&gt; |ok
report|1|1561888072.462184|smtp-in|protocol-server|d812eceafa0ae39e|250 2.1.5 Destination address valid: Recipient ok
report|1|1561888072.462496|smtp-in|protocol-client|d812eceafa0ae39e|DATA
report|1|1561888072.462638|smtp-in|filter-response|d812eceafa0ae39e|data|proceed
report|1|1561888072.463142|smtp-in|tx-data|d812eceafa0ae39e|754cbaa4|ok
report|1|1561888072.463147|smtp-in|protocol-server|d812eceafa0ae39e|354 Enter mail, end with &#34;.&#34; on a line by itself
report|1|1561888072.463866|smtp-in|protocol-client|d812eceafa0ae39e|.
report|1|1561888072.463997|smtp-in|filter-response|d812eceafa0ae39e|commit|proceed
report|1|1561888072.464034|smtp-in|tx-commit|d812eceafa0ae39e|754cbaa4|477
report|1|1561888072.465786|smtp-in|protocol-server|d812eceafa0ae39e|250 2.0.0: 754cbaa4 Message accepted for delivery
report|1|1561888072.466065|smtp-in|protocol-client|d812eceafa0ae39e|QUIT
report|1|1561888072.466294|smtp-in|filter-response|d812eceafa0ae39e|quit|proceed
report|1|1561888072.466300|smtp-in|protocol-server|d812eceafa0ae39e|221 2.0.0: Bye
report|1|1561888072.466481|smtp-in|link-disconnect|d812eceafa0ae39e
</code></pre><h2 id=libopensmtpd>libopensmtpd</h2><p>The filters protocol is a very simple line-based protocol that I already explained in previous blog posts,
but while writing filters in various scripting languages is simple,
writing a filter in C was still a bit tedious.</p><p>I started writing a <code>libopensmtpd</code> to provide a straightforward method for writing native C filters.
It is not ready yet for publishing but it is already functional and works enough to trigger all hooks.</p><p>All it takes is:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ cc -o /tmp/filter-debug debug.c -lopensmtpd
</span></span><span style=display:flex><span>$
</span></span></code></pre></div><p>To make the following filter usable:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#6272a4>/*
</span></span></span><span style=display:flex><span><span style=color:#6272a4> * Copyright (c) 2019 Gilles Chehade &lt;gilles@poolp.org&gt;
</span></span></span><span style=display:flex><span><span style=color:#6272a4> *
</span></span></span><span style=display:flex><span><span style=color:#6272a4> * Permission to use, copy, modify, and distribute this software for any
</span></span></span><span style=display:flex><span><span style=color:#6272a4> * purpose with or without fee is hereby granted, provided that the above
</span></span></span><span style=display:flex><span><span style=color:#6272a4> * copyright notice and this permission notice appear in all copies.
</span></span></span><span style=display:flex><span><span style=color:#6272a4> *
</span></span></span><span style=display:flex><span><span style=color:#6272a4> * THE SOFTWARE IS PROVIDED &#34;AS IS&#34; AND THE AUTHOR DISCLAIMS ALL WARRANTIES
</span></span></span><span style=display:flex><span><span style=color:#6272a4> * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
</span></span></span><span style=display:flex><span><span style=color:#6272a4> * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
</span></span></span><span style=display:flex><span><span style=color:#6272a4> * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
</span></span></span><span style=display:flex><span><span style=color:#6272a4> * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
</span></span></span><span style=display:flex><span><span style=color:#6272a4> * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
</span></span></span><span style=display:flex><span><span style=color:#6272a4> * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
</span></span></span><span style=display:flex><span><span style=color:#6272a4> */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>#include</span> <span style=color:#ff79c6>&lt;err.h&gt;</span><span style=color:#ff79c6>
</span></span></span><span style=display:flex><span><span style=color:#ff79c6>#include</span> <span style=color:#ff79c6>&lt;inttypes.h&gt;</span><span style=color:#ff79c6>
</span></span></span><span style=display:flex><span><span style=color:#ff79c6>#include</span> <span style=color:#ff79c6>&lt;stdlib.h&gt;</span><span style=color:#ff79c6>
</span></span></span><span style=display:flex><span><span style=color:#ff79c6></span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>#include</span> <span style=color:#ff79c6>&#34;opensmtpd.h&#34;</span><span style=color:#ff79c6>
</span></span></span><span style=display:flex><span><span style=color:#ff79c6></span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>extern</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>__progname;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4>/* reporting */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>report_link_connect</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>rdns, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>fcrdns, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>src, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>dest)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;report_link_connect: rdns=%s, fcrdns=%s, src=%s, dest=%s&#34;</span>,
</span></span><span style=display:flex><span>	    rdns, fcrdns, src, dest);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>report_link_disconnect</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;report_link_disconnect&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>report_link_identify</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>helo_name)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;report_link_identify: helo_name=%s&#34;</span>,
</span></span><span style=display:flex><span>		helo_name);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>report_link_tls</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>tls_line)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;report_link_tls: tls_line=%s&#34;</span>,
</span></span><span style=display:flex><span>	    tls_line);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>report_tx_begin</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#8be9fd>uint32_t</span> msgid)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;report_tx_begin: msgid=%08x&#34;</span>,
</span></span><span style=display:flex><span>	    msgid);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>report_tx_mail</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#8be9fd>uint32_t</span> msgid, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>mail_from, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>result)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;report_tx_mail: msgid=%08x, mail_from=%s, result=%s&#34;</span>,
</span></span><span style=display:flex><span>	    msgid, mail_from, result);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>report_tx_rcpt</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#8be9fd>uint32_t</span> msgid, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>rcpt_to, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>result)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;report_tx_rcpt: msgid=%08x, mail_from=%s, result=%s&#34;</span>,
</span></span><span style=display:flex><span>	    msgid, rcpt_to, result);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>report_tx_envelope</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#8be9fd>uint32_t</span> msgid, <span style=color:#8be9fd>uint64_t</span> evpid)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;report_tx_envelope: msgid=%08x, evpid=%016&#34;</span>PRIx64<span style=color:#f1fa8c>&#34;&#34;</span>,
</span></span><span style=display:flex><span>	    msgid, evpid);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>report_tx_commit</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#8be9fd>uint32_t</span> msgid)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;report_tx_commit: msgid=%08x&#34;</span>,
</span></span><span style=display:flex><span>	    msgid);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>report_tx_data</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#8be9fd>uint32_t</span> msgid, <span style=color:#8be9fd>size_t</span> msg_size)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;report_tx_data: msgid=%08x, msg_size=%zd&#34;</span>,
</span></span><span style=display:flex><span>	    msgid, msg_size);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>report_tx_rollback</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#8be9fd>uint32_t</span> msgid)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;report_tx_rollback: msgid=%08x&#34;</span>,
</span></span><span style=display:flex><span>	    msgid);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>report_protocol_client</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>line)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;report_protocol_client: line=%s&#34;</span>,
</span></span><span style=display:flex><span>	    line);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>report_protocol_server</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>line)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;report_protocol_server: line=%s&#34;</span>,
</span></span><span style=display:flex><span>	    line);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>report_filter_response</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>phase, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>response)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;report_filter_response: phase=%s, response=%s&#34;</span>,
</span></span><span style=display:flex><span>	    phase, response);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>report_timeout</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;report_timeout&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4>/* filtering */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>filter_connect</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>rdns, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>arg)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;filter_connect: rdns=%s, arg=%s&#34;</span>, rdns, arg);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>proceed</span>(ctx);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>filter_helo</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>arg)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;filter_helo: arg=%s&#34;</span>, arg);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>proceed</span>(ctx);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>filter_ehlo</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>arg)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;filter_ehlo: arg=%s&#34;</span>, arg);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>proceed</span>(ctx);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>filter_starttls</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>arg)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;filter_starttls: arg=%s&#34;</span>, arg);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>proceed</span>(ctx);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>filter_auth</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>arg)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;filter_auth: arg=%s&#34;</span>, arg);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>proceed</span>(ctx);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>filter_mail_from</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>arg)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;filter_mail_from: arg=%s&#34;</span>, arg);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>proceed</span>(ctx);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>filter_rcpt_to</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>arg)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;filter_rcpt_to: arg=%s&#34;</span>, arg);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>proceed</span>(ctx);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>filter_data</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>arg)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;filter_data: arg=%s&#34;</span>, arg);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>proceed</span>(ctx);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>filter_data_line</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>arg)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;filter_data_line: arg=%s&#34;</span>, arg);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>dataline</span>(ctx, arg);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>filter_rset</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>arg)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;filter_rset: arg=%s&#34;</span>, arg);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>proceed</span>(ctx);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>filter_quit</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>arg)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;filter_quit: arg=%s&#34;</span>, arg);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>proceed</span>(ctx);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>filter_noop</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>arg)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;filter_noop: arg=%s&#34;</span>, arg);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>proceed</span>(ctx);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>filter_help</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>arg)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;filter_help: arg=%s&#34;</span>, arg);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>proceed</span>(ctx);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>filter_wiz</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>arg)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;filter_wiz: arg=%s&#34;</span>, arg);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>proceed</span>(ctx);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>filter_commit</span>(<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx, <span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>arg)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>warnx</span>(<span style=color:#f1fa8c>&#34;filter_commit: arg=%s&#34;</span>, arg);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>proceed</span>(ctx);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8be9fd>int</span>
</span></span><span style=display:flex><span><span style=color:#50fa7b>main</span>(<span style=color:#8be9fd>int</span> argc, <span style=color:#8be9fd>char</span> <span style=color:#ff79c6>*</span>argv[])
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#8be9fd>opensmtpd_ctx_t</span> <span style=color:#ff79c6>*</span>ctx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#ff79c6>if</span> (argc <span style=color:#ff79c6>!=</span> <span style=color:#bd93f9>1</span>)
</span></span><span style=display:flex><span>		<span style=color:#50fa7b>errx</span>(<span style=color:#bd93f9>1</span>, <span style=color:#f1fa8c>&#34;usage: %s&#34;</span>, __progname);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_init</span>(<span style=color:#ff79c6>&amp;</span>ctx);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_report</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;link-connect&#34;</span>, report_link_connect);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_report</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;link-disconnect&#34;</span>, report_link_disconnect);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_report</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;link-identify&#34;</span>, report_link_identify);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_report</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;link-tls&#34;</span>, report_link_tls);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_report</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;tx-begin&#34;</span>, report_tx_begin);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_report</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;tx-mail&#34;</span>, report_tx_mail);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_report</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;tx-rcpt&#34;</span>, report_tx_rcpt);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_report</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;tx-envelope&#34;</span>, report_tx_envelope);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_report</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;tx-data&#34;</span>, report_tx_data);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_report</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;tx-commit&#34;</span>, report_tx_commit);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_report</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;tx-rollback&#34;</span>, report_tx_rollback);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_report</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;protocol-client&#34;</span>, report_protocol_client);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_report</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;protocol-server&#34;</span>, report_protocol_server);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_report</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;filter-response&#34;</span>, report_filter_response);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_report</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;timeout&#34;</span>, report_timeout);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_filter</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;connect&#34;</span>, filter_connect);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_filter</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;helo&#34;</span>, filter_helo);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_filter</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;ehlo&#34;</span>, filter_ehlo);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_filter</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;starttls&#34;</span>, filter_starttls);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_filter</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;auth&#34;</span>, filter_auth);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_filter</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;mail-from&#34;</span>, filter_mail_from);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_filter</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;rcpt-to&#34;</span>, filter_rcpt_to);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_filter</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;data&#34;</span>, filter_data);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_filter</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;rset&#34;</span>, filter_rset);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_filter</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;quit&#34;</span>, filter_quit);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_filter</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;noop&#34;</span>, filter_noop);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_filter</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;help&#34;</span>, filter_help);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_filter</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;wiz&#34;</span>, filter_wiz);
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_filter</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;commit&#34;</span>, filter_commit);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#50fa7b>smtpd_on_filter</span>(ctx, <span style=color:#f1fa8c>&#34;smtp-in&#34;</span>, <span style=color:#f1fa8c>&#34;data-line&#34;</span>, filter_data_line);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#ff79c6>if</span> (<span style=color:#ff79c6>!</span> <span style=color:#50fa7b>smtpd_event_loop</span>(ctx))
</span></span><span style=display:flex><span>		<span style=color:#ff79c6>return</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#ff79c6>return</span> <span style=color:#bd93f9>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>and register all hooks:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>laptop$ /tmp/filter-debug
</span></span><span style=display:flex><span>register|report|smtp-in|filter-response
</span></span><span style=display:flex><span>register|report|smtp-in|link-connect
</span></span><span style=display:flex><span>register|report|smtp-in|link-disconnect
</span></span><span style=display:flex><span>register|report|smtp-in|link-identify
</span></span><span style=display:flex><span>register|report|smtp-in|link-tls
</span></span><span style=display:flex><span>register|report|smtp-in|protocol-client
</span></span><span style=display:flex><span>register|report|smtp-in|protocol-server
</span></span><span style=display:flex><span>register|report|smtp-in|timeout
</span></span><span style=display:flex><span>register|report|smtp-in|tx-begin
</span></span><span style=display:flex><span>register|report|smtp-in|tx-commit
</span></span><span style=display:flex><span>register|report|smtp-in|tx-data
</span></span><span style=display:flex><span>register|report|smtp-in|tx-envelope
</span></span><span style=display:flex><span>register|report|smtp-in|tx-mail
</span></span><span style=display:flex><span>register|report|smtp-in|tx-rcpt
</span></span><span style=display:flex><span>register|report|smtp-in|tx-rollback
</span></span><span style=display:flex><span>register|filter|smtp-in|auth
</span></span><span style=display:flex><span>register|filter|smtp-in|commit
</span></span><span style=display:flex><span>register|filter|smtp-in|connect
</span></span><span style=display:flex><span>register|filter|smtp-in|data
</span></span><span style=display:flex><span>register|filter|smtp-in|data-line
</span></span><span style=display:flex><span>register|filter|smtp-in|ehlo
</span></span><span style=display:flex><span>register|filter|smtp-in|helo
</span></span><span style=display:flex><span>register|filter|smtp-in|<span style=color:#8be9fd;font-style:italic>help</span>
</span></span><span style=display:flex><span>register|filter|smtp-in|mail-from
</span></span><span style=display:flex><span>register|filter|smtp-in|noop
</span></span><span style=display:flex><span>register|filter|smtp-in|quit
</span></span><span style=display:flex><span>register|filter|smtp-in|rcpt-to
</span></span><span style=display:flex><span>register|filter|smtp-in|rset
</span></span><span style=display:flex><span>register|filter|smtp-in|starttls
</span></span><span style=display:flex><span>register|filter|smtp-in|wiz
</span></span><span style=display:flex><span>register|ready
</span></span><span style=display:flex><span>^C
</span></span><span style=display:flex><span>laptop$
</span></span></code></pre></div><p>In OpenSMTPD, with the following config:</p><pre tabindex=0><code>[...]
filter foobar proc-exec &#34;/tmp/filter-debug&#34;

listen on socket filter foobar
</code></pre><p>it will result in the following output:</p><pre tabindex=0><code>[...]
86c0820a13ffee17 smtp connected address=local host=laptop.home
&lt;dynproc:00000001&gt;: filter-debug: report_link_connect: rdns=laptop.home, fcrdns=pass, src=local:0, dest=local:0
&lt;dynproc:00000001&gt;: filter-debug: filter_connect: rdns=laptop.home, arg=local
&lt;dynproc:00000001&gt;: filter-debug: report_filter_response: phase=connected, response=proceed
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_server: line=220 laptop.home ESMTP OpenSMTPD
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_client: line=EHLO localhost
&lt;dynproc:00000001&gt;: filter-debug: filter_ehlo: arg=localhost
&lt;dynproc:00000001&gt;: filter-debug: report_filter_response: phase=ehlo, response=proceed
&lt;dynproc:00000001&gt;: filter-debug: report_link_identify: helo_name=localhost
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_server: line=250-laptop.home Hello localhost [local], pleased to meet you
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_server: line=250-8BITMIME
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_server: line=250-ENHANCEDSTATUSCODES
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_server: line=250-SIZE 36700160
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_server: line=250-DSN
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_server: line=250 HELP
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_client: line=MAIL FROM:&lt;gilles@laptop.home&gt;
&lt;dynproc:00000001&gt;: filter-debug: filter_mail_from: arg=gilles@laptop.home
&lt;dynproc:00000001&gt;: filter-debug: report_filter_response: phase=mail-from, response=proceed
&lt;dynproc:00000001&gt;: filter-debug: report_tx_begin: msgid=2b8bbe3b
&lt;dynproc:00000001&gt;: filter-debug: report_tx_mail: msgid=2b8bbe3b, mail_from=&lt;gilles@laptop.home&gt;, result=ok
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_server: line=250 2.0.0: Ok
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_client: line=RCPT TO:&lt;gilles@laptop.home&gt;
&lt;dynproc:00000001&gt;: filter-debug: filter_rcpt_to: arg=gilles@laptop.home
&lt;dynproc:00000001&gt;: filter-debug: report_filter_response: phase=rcpt-to, response=proceed
&lt;dynproc:00000001&gt;: filter-debug: report_tx_envelope: msgid=2b8bbe3b, evpid=2b8bbe3b60567a11
&lt;dynproc:00000001&gt;: filter-debug: report_tx_rcpt: msgid=2b8bbe3b, mail_from=&lt;gilles@laptop.home&gt;, result=ok
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_server: line=250 2.1.5 Destination address valid: Recipient ok
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_client: line=DATA
&lt;dynproc:00000001&gt;: filter-debug: filter_data: arg=
&lt;dynproc:00000001&gt;: filter-debug: report_filter_response: phase=data, response=proceed
&lt;dynproc:00000001&gt;: filter-debug: filter_data_line: arg=Received: from localhost (laptop.home [local])
&lt;dynproc:00000001&gt;: filter-debug: filter_data_line: arg=        by laptop.home (OpenSMTPD) with ESMTPA id 2b8bbe3b
&lt;dynproc:00000001&gt;: filter-debug: filter_data_line: arg=        for &lt;gilles@laptop.home&gt;;
&lt;dynproc:00000001&gt;: filter-debug: filter_data_line: arg=        Sun, 30 Jun 2019 12:01:55 +0200 (CEST)
&lt;dynproc:00000001&gt;: filter-debug: report_tx_data: msgid=2b8bbe3b, msg_size=10034375646789
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_server: line=354 Enter mail, end with &#34;.&#34; on a line by itself
&lt;dynproc:00000001&gt;: filter-debug: filter_data_line: arg=From:  &lt;gilles@laptop.home&gt;
&lt;dynproc:00000001&gt;: filter-debug: filter_data_line: arg=Date: Sun, 30 Jun 2019 12:01:55 +0200 (CEST)
&lt;dynproc:00000001&gt;: filter-debug: filter_data_line: arg=To: gilles
&lt;dynproc:00000001&gt;: filter-debug: filter_data_line: arg=
&lt;dynproc:00000001&gt;: filter-debug: filter_data_line: arg=test
&lt;dynproc:00000001&gt;: filter-debug: filter_data_line: arg=.
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_client: line=.
&lt;dynproc:00000001&gt;: filter-debug: filter_commit: arg=
&lt;dynproc:00000001&gt;: filter-debug: report_filter_response: phase=commit, response=proceed
&lt;dynproc:00000001&gt;: filter-debug: report_tx_commit: msgid=2b8bbe3b
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_server: line=250 2.0.0: 2b8bbe3b Message accepted for delivery
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_client: line=QUIT
&lt;dynproc:00000001&gt;: filter-debug: filter_quit: arg=
[...]
</code></pre><h2 id=filter-rspamd-in-progress>filter-rspamd in progress</h2><p>I had written a filter-rspamd for OpenSMTPD in python already,
however it was a proof-of-concept more than a real filter and I didn&rsquo;t make it really robust.</p><p>With <code>libopensmtpd</code> at hands,
I decided to write a native C filter-rspamd that I would officially maintain,
one that would be robust enough to be used in production.</p><p>I had most of the logic done in half an hour,
unfortunately I ran out of time for this &ldquo;free&rdquo; week and didn&rsquo;t complete the filter.</p><p>Basically as it is right now, the filter will build everything needed for the call to <code>rspamd</code>,
but I didn&rsquo;t write the http request.</p><p>I will surely finish that during my next &ldquo;free&rdquo; week.</p><h2 id=what-next->What next ?</h2><p>Well, see you in a month for the July report.</p><p>Hopefully, by then I will have finished my filter-rspamd, I will have released an initial version of FION,
and I will have released an initial version of libopensmtpd.</p><p>When I&rsquo;m done with FION and have decided what to to with BPG,
I will have a look at some of my other private repositories to see what can be released :-)</p><p>If you like my work, <a href=https://patreon.com/gilles target=_blank rel=noopener>support me on patreon</a> !</p><hr><p>Comments: <a href=https://github.com/poolpOrg/poolp.org/discussions/102 target=_blank rel=noopener>https://github.com/poolpOrg/poolp.org/discussions/102</a></p><script src=https://giscus.app/client.js data-repo=poolpOrg/poolp.org data-repo-id="MDEwOlJlcG9zaXRvcnkxMjYxODk2MjA=" data-category=Articles data-category-id=DIC_kwDOB4WANM4B-Zf1 data-mapping=og:title data-strict=0 data-reactions-enabled=1 data-emit-metadata=1 data-input-position=top data-theme=light data-lang=en data-loading=lazy crossorigin=anonymous async></script></article></div></div><script type=text/javascript src=/main.js defer></script></body></html>