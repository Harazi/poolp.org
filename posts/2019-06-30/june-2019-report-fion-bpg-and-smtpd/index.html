<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=light data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><title>June 2019 report: fion, bpg and smtpd &#183; poolp.org</title><meta name=title content="June 2019 report: fion, bpg and smtpd &#183; poolp.org"><link rel=canonical href=https://poolp.org/posts/2019-06-30/june-2019-report-fion-bpg-and-smtpd/><link type=text/css rel=stylesheet href=/css/main.bundle.min.76abfc0f34eaae60b8ce616fea2e1a46a463cd7fe4221b14640c181cf5634b6fc8560b693e2a4e7f615e579674b3a8bd285652e8de59695ee2d357065078ff86.css integrity="sha512-dqv8DzTqrmC4zmFv6i4aRqRjzX/kIhsUZAwYHPVjS2/IVgtpPipOf2FeV5Z0s6i9KFZS6N5ZaV7i01cGUHj/hg=="><script type=text/javascript src=/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
<script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.3ddcf04f5b0d4c32f72e726d3c12eebccd8c3c9f9daa9a13414808895de0ae1e1cdddda6849680d5bd96dbb60d0b1e0b24c29f5c83e5631e55e7e6bc02015490.js integrity="sha512-PdzwT1sNTDL3LnJtPBLuvM2MPJ+dqpoTQUgIiV3grh4c3d2mhJaA1b2W27YNCx4LJMKfXIPlYx5V5+a8AgFUkA==" data-copy data-copied></script>
<script src=/js/zoom.min.js></script>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:title" content="June 2019 report: fion, bpg and smtpd"><meta property="og:description" content="TL;DR: - started working on FION, a static tile window manager - revived BPG, a PGP parser - converted OpenSMTPD to libtls - wrote a library to make writing of native C OpenSMTPD filters easy - started writing a filter-rspamd Thanks to my patrons !"><meta property="og:type" content="article"><meta property="og:url" content="https://poolp.org/posts/2019-06-30/june-2019-report-fion-bpg-and-smtpd/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-06-30T07:42:00+00:00"><meta property="article:modified_time" content="2019-06-30T07:42:00+00:00"><meta property="og:site_name" content="poolp.org"><meta name=twitter:card content="summary"><meta name=twitter:title content="June 2019 report: fion, bpg and smtpd"><meta name=twitter:description content="TL;DR: - started working on FION, a static tile window manager - revived BPG, a PGP parser - converted OpenSMTPD to libtls - wrote a library to make writing of native C OpenSMTPD filters easy - started writing a filter-rspamd Thanks to my patrons !"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"June 2019 report: fion, bpg and smtpd","headline":"June 2019 report: fion, bpg and smtpd","abstract":"TL;DR: - started working on FION, a static tile window manager - revived BPG, a PGP parser - converted OpenSMTPD to libtls - wrote a library to make writing of native C OpenSMTPD filters easy - started writing a filter-rspamd Thanks to my patrons !","inLanguage":"en","url":"https:\/\/poolp.org\/posts\/2019-06-30\/june-2019-report-fion-bpg-and-smtpd\/","author":{"@type":"Person","name":""},"copyrightYear":"2019","dateCreated":"2019-06-30T07:42:00\u002b00:00","datePublished":"2019-06-30T07:42:00\u002b00:00","dateModified":"2019-06-30T07:42:00\u002b00:00","mainEntityOfPage":"true","wordCount":"3530"}]</script><script src=/lib/jquery/jquery.slim.min.js integrity></script><meta name=theme-color></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a></div><div style=padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3"><div><a href=/ class=flex><span class=sr-only>poolp.org</span>
<img src=/img/poolp_org.png width=150 height=51 class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt=poolp.org></a></div><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium text-gray-500 hover:text-gray-900">poolp.org</a></nav><nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12"><a href=/posts/ class="flex items-center"><p class="text-base font-medium text-gray-500 hover:text-gray-900" title=Posts>Blog</p></a><a href=/series/ class="flex items-center"><p class="text-base font-medium text-gray-500 hover:text-gray-900" title=Series>Series</p></a><a href=/categories/ class="flex items-center"><p class="text-base font-medium text-gray-500 hover:text-gray-900" title=Categories>Categories</p></a><a href=/tags/ class="flex items-center"><p class="text-base font-medium text-gray-500 hover:text-gray-900" title=Tags>Tags</p></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400 h-12" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="ltr:mr-14 rtl:ml-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"><button id=appearance-switcher aria-label="Dark mode switcher" type=button><div class="flex items-center justify-center h-12 dark:hidden"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden h-12 dark:flex"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center space-x-5 md:ml-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button style=margin-right:5px><div class="flex items-center justify-center h-12 dark:hidden"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden h-12 dark:flex"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 -mr-2 md:hidden"><label id=menu-button for=menu-controller class=block><input type=checkbox id=menu-controller class=hidden><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper style=padding-top:5px class="fixed inset-0 z-30 invisible w-screen h-screen m-auto overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl"><li><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/posts/ class="flex items-center"><p class="text-bg font-bg text-gray-500 hover:text-gray-900" title=Posts>Blog</p></a></li><li class=mt-1><a href=/series/ class="flex items-center"><p class="text-bg font-bg text-gray-500 hover:text-gray-900" title=Series>Series</p></a></li><li class=mt-1><a href=/categories/ class="flex items-center"><p class="text-bg font-bg text-gray-500 hover:text-gray-900" title=Categories>Categories</p></a></li><li class=mt-1><a href=/tags/ class="flex items-center"><p class="text-bg font-bg text-gray-500 hover:text-gray-900" title=Tags>Tags</p></a></li></ul><hr><ul class="flex mt-4 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl"><li class=mb-1><a href=/categories/personal/ class="flex items-center"><p class="text-sm font-sm text-gray-500 hover:text-gray-900" title=personal>Personal</p></a></li><li class=mb-1><a href=/categories/technology/ class="flex items-center"><p class="text-sm font-sm text-gray-500 hover:text-gray-900" title=technology>Technology</p></a></li><li class=mb-1><a href class="flex items-center"><p class="text-sm font-sm text-gray-500 hover:text-gray-900" title>Music</p></a></li></ul></div></label></div></div><div class="main-menu flex pb-3 flex-col items-end justify-between md:justify-start space-x-3" style=margin-top:-15px><div class="hidden md:flex items-center space-x-5"><a href=/categories/personal/ class="flex items-center"><p class="text-xs font-light text-gray-500 hover:text-gray-900" title=personal>Personal</p></a><a href=/categories/technology/ class="flex items-center"><p class="text-xs font-light text-gray-500 hover:text-gray-900" title=technology>Technology</p></a><a href class="flex items-center"><p class="text-xs font-light text-gray-500 hover:text-gray-900" title>Music</p></a></div></div><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header id=single_header class="mt-5 max-w-prose"><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class="inline hidden"><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/>poolp.org</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/>Posts</a><span class="px-1 text-primary-500">/</span></li><li class="inline hidden"><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/2019-06-30/june-2019-report-fion-bpg-and-smtpd/>June 2019 report: fion, bpg and smtpd</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">June 2019 report: fion, bpg and smtpd</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2019-06-30 07:42:00 +0000 UTC">30 June 2019</time><span class="px-2 text-primary-500">&#183;</span><span>3530 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">17 mins</span><span class="px-2 text-primary-500">&#183;</span>
<span class=mb-[2px]><a href=https://github.com/poolpOrg/poolp.org/tree/master/content/posts/2019-06-30/index.md class="text-lg hover:text-primary-500" rel="noopener noreferrer" target=_blank title="Edit content"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M490.3 40.4c21.9 21.87 21.9 57.33.0 79.2l-30 30.1-98-97.98 30.1-30.06C414.3-.2135 449.7-.2135 471.6 21.66L490.3 40.4zM172.4 241.7 339.7 74.34l98 97.96L270.3 339.6C264.2 345.8 256.7 350.4 248.4 353.2l-88.8 29.6C150.1 385.6 141.5 383.4 135 376.1 128.6 370.5 126.4 361 129.2 352.4l29.6-88.8C161.6 255.3 166.2 247.8 172.4 241.7v0zM192 63.1c17.7.0 32 15.23 32 32 0 18.6-14.3 32-32 32H96c-17.67.0-32 15.2-32 32V416c0 17.7 14.33 32 32 32H352c17.7.0 32-14.3 32-32V319.1c0-16.8 14.3-32 32-32s32 15.2 32 32V416c0 53-43 96-96 96H96c-53.02.0-96-43-96-96V159.1c0-53 42.98-96 96-96h96z"/></svg></span></span></a></span></div><div class="flex flex-row flex-wrap items-center"><div style=cursor:pointer onclick='window.open("/authors/gilles/","_self")'>Gilles Chehade</div></div><div class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/categories/technology/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">technology</span></span></span></div></div><div class=flex><div class=place-self-center><div class="text-2xl sm:text-lg"></div></div></div><div class="flex mt-4"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width=96 height=96 src=/img/gilles_hu897fc9ad11a292e594efc0b9f1eaea51_1273455_192x192_fill_q75_box_center.jpg><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><a href=https://poolp.org//authors/gilles class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Gilles Chehade</a><div class="text-sm text-neutral-700 dark:text-neutral-400">I&rsquo;m not a cat.</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=mailto:gilles@poolp.org target=_blank aria-label=Email rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://discord.gg/YC6j4rbvSk target=_blank aria-label=Discord rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentcolor" d="M524.531 69.836a1.5 1.5.0 00-.764-.7A485.065 485.065.0 00404.081 32.03a1.816 1.816.0 00-1.923.91 337.461 337.461.0 00-14.9 30.6 447.848 447.848.0 00-134.426.0 309.541 309.541.0 00-15.135-30.6 1.89 1.89.0 00-1.924-.91A483.689 483.689.0 00116.085 69.137a1.712 1.712.0 00-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016.0 00.765 1.375A487.666 487.666.0 00176.02 479.918a1.9 1.9.0 002.063-.676A348.2 348.2.0 00208.12 430.4a1.86 1.86.0 00-1.019-2.588 321.173 321.173.0 01-45.868-21.853 1.885 1.885.0 01-.185-3.126c3.082-2.309 6.166-4.711 9.109-7.137a1.819 1.819.0 011.9-.256c96.229 43.917 200.41 43.917 295.5.0a1.812 1.812.0 011.924.233c2.944 2.426 6.027 4.851 9.132 7.16a1.884 1.884.0 01-.162 3.126 301.407 301.407.0 01-45.89 21.83 1.875 1.875.0 00-1 2.611 391.055 391.055.0 0030.014 48.815 1.864 1.864.0 002.063.7A486.048 486.048.0 00610.7 405.729a1.882 1.882.0 00.765-1.352C623.729 277.594 590.933 167.465 524.531 69.836zM222.491 337.58c-28.972.0-52.844-26.587-52.844-59.239S193.056 219.1 222.491 219.1c29.665.0 53.306 26.82 52.843 59.239.0 32.654-23.41 59.241-52.843 59.241zm195.38.0c-28.971.0-52.843-26.587-52.843-59.239S388.437 219.1 417.871 219.1c29.667.0 53.307 26.82 52.844 59.239.0 32.654-23.177 59.241-52.844 59.241z"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/poolpOrg target=_blank aria-label=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://linkedin.com/in/gilleschehade target=_blank aria-label=Linkedin rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://social.poolp.org/@gilles target=_blank aria-label=Mastodon rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48.0.0.0-63.72 28.5-63.72 125.7.0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54.0 01-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://www.patreon.com/gilles target=_blank aria-label=Patreon rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M512 194.8c0 101.3-82.4 183.8-183.8 183.8-101.7.0-184.4-82.4-184.4-183.8.0-101.6 82.7-184.3 184.4-184.3C429.6 10.5 512 93.2 512 194.8zM0 501.5h90v-491H0v491z"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://reddit.com/user/poolpOrg target=_blank aria-label=Reddit rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M201.5 305.5c-13.8.0-24.9-11.1-24.9-24.6.0-13.8 11.1-24.9 24.9-24.9 13.6.0 24.6 11.1 24.6 24.9.0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4.0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7.0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9.0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5.0 52.6 59.2 95.2 132 95.2 73.1.0 132.3-42.6 132.3-95.2.0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6.0-2.2-2.2-6.1-2.2-8.3.0-2.5 2.5-2.5 6.4.0 8.6 22.8 22.8 87.3 22.8 110.2.0 2.5-2.2 2.5-6.1.0-8.6-2.2-2.2-6.1-2.2-8.3.0zm7.7-75c-13.6.0-24.6 11.1-24.6 24.9.0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.1 24.9-24.6.0-13.8-11-24.9-24.9-24.9z"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://twitter.com/poolpOrg target=_blank aria-label=Twitter rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://www.youtube.com/gilleschehade target=_blank aria-label=Youtube rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78.0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg></span></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first sm:max-w-prose lg:ml-auto px-0 lg:order-last lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8"><div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-10"><details open class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#thanks-to-my-patrons->Thanks to my patrons !</a></li><li><a href=#fion-a-featureless-ion>FION: a featureless ion</a></li><li><a href=#fions-feature>FION&rsquo;s feature</a></li><li><a href=#obligatory-screenshots>Obligatory screenshots</a></li><li><a href=#bpg-bsd-privacy-guard>BPG: BSD Privacy Guard</a></li><li><a href=#opensmtpd>OpenSMTPD:</a></li><li><a href=#opensmtpd-openssl---libtls-migration>OpenSMTPD: OpenSSL -> libtls migration</a></li><li><a href=#opensmtpd-filters>OpenSMTPD: Filters</a></li><li><a href=#timestamps-in-filter-events>timestamps in filter events</a></li><li><a href=#filter-strderr-mapped-to-log_warn>filter strderr mapped to <code>log_warn()</code></a></li><li><a href=#filter-eventlog>filter-eventlog</a></li><li><a href=#libopensmtpd>libopensmtpd</a></li><li><a href=#filter-rspamd-in-progress>filter-rspamd in progress</a></li><li><a href=#what-next->What next ?</a></li></ul></nav></div></details><details class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#thanks-to-my-patrons->Thanks to my patrons !</a></li><li><a href=#fion-a-featureless-ion>FION: a featureless ion</a></li><li><a href=#fions-feature>FION&rsquo;s feature</a></li><li><a href=#obligatory-screenshots>Obligatory screenshots</a></li><li><a href=#bpg-bsd-privacy-guard>BPG: BSD Privacy Guard</a></li><li><a href=#opensmtpd>OpenSMTPD:</a></li><li><a href=#opensmtpd-openssl---libtls-migration>OpenSMTPD: OpenSSL -> libtls migration</a></li><li><a href=#opensmtpd-filters>OpenSMTPD: Filters</a></li><li><a href=#timestamps-in-filter-events>timestamps in filter events</a></li><li><a href=#filter-strderr-mapped-to-log_warn>filter strderr mapped to <code>log_warn()</code></a></li><li><a href=#filter-eventlog>filter-eventlog</a></li><li><a href=#libopensmtpd>libopensmtpd</a></li><li><a href=#filter-rspamd-in-progress>filter-rspamd in progress</a></li><li><a href=#what-next->What next ?</a></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-prose"><pre><code>TL;DR:
- started working on FION, a static tile window manager
- revived BPG, a PGP parser
- converted OpenSMTPD to libtls
- wrote a library to make writing of native C OpenSMTPD filters easy
- started writing a filter-rspamd
</code></pre><div id=thanks-to-my-patrons- class=anchor></div><h2 class="relative group">Thanks to my patrons !
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#thanks-to-my-patrons- aria-label=Anchor>#</a></span></h2><p>First of all,
a huge thanks to my first patrons:</p><ul><li>Bleader Raton</li><li>Diego Meseguer</li><li>Mischa Peters</li><li>Vegar Linge Halaand</li></ul><p>I have recently switched to a 75% part-time schedule at work so that I can spend
a &ldquo;free&rdquo; week each month working on my own stuff, mostly opensource, without any
kind of pressure: no one knows what I&rsquo;ll be working on and no one but me gets to
decide how I&rsquo;ll spend this time.</p><p>This comes at the cost of slashing a quarter of my wage, which is sustainable but
not ideal, so while most of my &ldquo;free&rdquo; weeks will be spent on opensource, I&rsquo;ll be
doing some sponsored development or short contracts to cover some of the loss if
needed.</p><p>I opened a patreon account so that people who care about my work can sponsor it,
allowing me to spend most (if not all) of these &ldquo;free&rdquo; weeks publishing code for
the community. If you want me to spend more time doing this then you know what
to do: <a href=https://www.patreon.com/gilles target=_blank>become my patron</a> !</p><p>So thanks again to my patrons who make this possible, I will list them in all of
my monthly reports, they are the sponsors of the work I describe below.</p><div id=fion-a-featureless-ion class=anchor></div><h2 class="relative group">FION: a featureless ion
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#fion-a-featureless-ion aria-label=Anchor>#</a></span></h2><p>I&rsquo;m not too much of a graphical interface person,
so when I was shown the ion window manager in 2003 I became addicted and,
ever since,
it&rsquo;s been very hard for me to work efficiently using anything else.
This is not an elitist thing,
it is really me being easily distracted by stuff like windows not being properly
aligned and similar stupid concerns that actually slow me considerably.
I call this the &ldquo;oh-a-butterfy&rdquo; effect.</p><p>Unfortunately,
the last ion release dates from 2009 and is unmaintained.
This leads to multiple problems,
one being the lack of modern features, like multi-screen, which is essential for
me considering the amount of time I spend reading code and specs side-to-side.
Another problem is the fact that it&rsquo;s been removed from most repositories, and I
keep having to build it from source here and there.
Recently it&rsquo;s been a bit more difficult because on some distro,
the dependencies for ion were no longer available and I had to start patching it
here and there so it could build.</p><p>I fear the day this happens on OpenBSD because it will mean that I have to spend
time maintaining a piece of code for which there&rsquo;s no upstream anymore &mldr; or be
back to working partly in console, partly in a maximized tmux when I really need
a browser visible.</p><p>I know this will lead people to tell me &ldquo;but there&rsquo;s notion, ion&rsquo;s fork&rdquo; or &ldquo;but
you can use awesome/dwm/i3/wmii/<insert yours here>&rdquo; but honestly I have tried a
lot of different window managers along the years to try getting away from ion as
it was abandoned and they never quite fit for me. I can only work if I have a wm
that does tabs within static tiles that I can h-split/v-split at will and resize
however I want. Notion came short because at least on OpenBSD it was laggy.</p><p>I might as well spend a few hours / days working on my own, learn how they work,
and release something I&rsquo;m willing to maintain on the long run as it scratches my
own itches.</p><div id=fions-feature class=anchor></div><h2 class="relative group">FION&rsquo;s feature
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#fions-feature aria-label=Anchor>#</a></span></h2><p>I didn&rsquo;t care that much for many of ion&rsquo;s feature, never used the lua binding or
the floating workspaces.</p><p>FION will simply implement what I intend to use, so at the time being, this is:</p><ul><li>pledge()-ed</li><li>multiple screens of different sizes</li><li>multiple workspaces per screen</li><li>workspaces may be split in multiple horizontal and vertical tiles</li><li>each tile may hold multiple X clients in tabs</li><li>tiles may be resized</li><li>screens / workspaces / tiles / tabs may be controlled through keyboard</li></ul><p>As of today, I&rsquo;d say I&rsquo;m halfway through, FION will detect screens and setup the
workspaces to match screen size. It can create as many workspaces as you want on
every single screen. It can h-split and v-split as many tiles as you want on the
current workspace. It can iterate through workspaces and tiles. It can start the
X clients and attach them, properly sized, to the current tile. It can give the
focus to a tile through keyboard-triggered iteration of tiles or by moving mouse
over a tile.</p><p>Can you try it yet ? nope.</p><p>FION currently does not have the logic to remove tiles, you can create and split
but not kill tiles, which is not hard to do but I just ran of time this week ;-)</p><p>Also, keyboard events are not properly handled yet so I had to map features to a
simple key like &rsquo;n&rsquo; or &lsquo;p&rsquo; to test them. Until I have more time for figuring out
how I can implement my keyboard shortcuts so that they use control sequences, it
will not be usable for daily use.</p><p>Code is already committed on Github but again &mldr; not usable, so stay tuned, the
first usable version will be announced on <a href=https://twitter.com/poolpOrg target=_blank>twitter</a>
when it&rsquo;s available.</p><div id=obligatory-screenshots class=anchor></div><h2 class="relative group">Obligatory screenshots
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#obligatory-screenshots aria-label=Anchor>#</a></span></h2><p>I must have spent about six hours worth of work on it and the result is quite ok
so I have good hope (no promise !) to make a first beta release during my &ldquo;free&rdquo;
week in July.</p><p>Here are a couple screenshots:</p><p>FION ran on my laptop a few days ago before X clients were resized to match tiles:</p><img alt="FION on my laptop screen" src=2019-06-30-fion_1.png width=100%>
[full screen](2019-06-30-fion_1.png)<p>FION ran on a bigger screen this morning:</p><img alt="FION on my 3440x1440 screen" src=2019-06-30-fion_2.png width=100%>
[full screen](2019-06-30-fion_2.png)<p>And because a project doesn&rsquo;t exist until it has a logo:</p><img alt="FION logo" src=2019-06-30-fion_logo.jpg width=100%>
[full screen](2019-06-30-fion_logo.jpg)<div id=bpg-bsd-privacy-guard class=anchor></div><h2 class="relative group">BPG: BSD Privacy Guard
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#bpg-bsd-privacy-guard aria-label=Anchor>#</a></span></h2><p>While looking at old private repositories to decide if I should axe them or not,
I ran into an interesting one: bpg.</p><p>Long story short,
while I was a student in 2002 or 2003,
I was doing night shifts at a security company to monitor firewalls and since it
was essentially a passive job because I had nothing to do until the screens went
all red, I started working on BPG a BSD-licensed PGP implementation.</p><p>Then, NetBSD came up with a similar project for a Google Summer of code and they
had someone already working on it, so I gave up as I had only a few weekly hours
available for this and my work would surely be less good than someone working on
it full-time for NetBSD.</p><p>Anyways,
I spent a while looking at the code to see what could be done with it, and it is
actually not bad at all.</p><p>I have a parser that can read all PGP packets in both old & new format, map them
to appropriate structures that can actually be used: it can essentially read the
keyrings and packets generated from gpg2, though it will not decrypt/verify.</p><p>The parser code was quite clean and I didn&rsquo;t make changes to it except remove an
allocator to replace it with <code>malloc_conceal(3)</code>. I did a bit of code cleanup on
other parts, like armoring which was ugly, but that&rsquo;s about it.</p><p>I don&rsquo;t know what to do about that code, I have no idea how usable is the NetBSD
implementation and how interesting it is for people to have another PGP utility.
I will release the parser for sure since the code is already here and maybe it&rsquo;s
going to be useful to someone but I&rsquo;m unsure if I should move project forward at
this point. Oh and I need a new name anyways because bpg is already taken and it
is certainly not going to be OpenBPG to avoid confusion with OpenBGP :-)</p><p>I have quickly written code to generate RSA keypairs just for fun:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>laptop$ bpg key gen rsa <span class=m>2048</span> &gt; /tmp/rsa2048.bpg
</span></span><span class=line><span class=cl>..........................................+++...................+++.
</span></span><span class=line><span class=cl>laptop$ bpg debug parse /tmp/rsa2048.bpg
</span></span><span class=line><span class=cl><span class=c1>## 05 : New format Secret-Key packet (920 bytes)</span>
</span></span><span class=line><span class=cl>        version: <span class=m>4</span>
</span></span><span class=line><span class=cl>        algorithm: RSA <span class=o>(</span>encrypt or sign<span class=o>)</span>
</span></span><span class=line><span class=cl>        keyid: e60e44654c3409be
</span></span><span class=line><span class=cl>        fingerprint: 7bfd297855a9c0d22a492ba2e60e44654c3409be
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 0d : New format User ID packet (16 bytes)</span>
</span></span><span class=line><span class=cl>        content: test@example.com
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>laptop$ cat /tmp/rsa2048.bpg
</span></span><span class=line><span class=cl>-----BEGIN PGP PRIVATE KEY BLOCK-----
</span></span><span class=line><span class=cl>Version: BPG v0.1 <span class=o>(</span>OpenBSD<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>xcLYBF0YccABCACzay1zxLQzD9WvOaF5DZXKIx5nmwP70+ff4XceepFnylwe7iKzTUF6W4kv
</span></span><span class=line><span class=cl>QxOF++z9SQ5mF0melyj0+TkJXUSs7MzNjuwb4OhDLiM9uVJ2J1wxA3KivY0pVjvJPtPTlMpZ
</span></span><span class=line><span class=cl>D7Ebb1CnagP75DEcgpdzWHDSzBbgHN89ct6M7fPZ756iDxHdnhO8syr9sB4GOJyj8hC2dC4y
</span></span><span class=line><span class=cl>qJvn7G7/BdQwDov23FUGcddWXIyPMs4GGbE+mpV1U6jqZbNUkGPl+Kh8CfRU15D2/60PsrgD
</span></span><span class=line><span class=cl>3OSDo3J/DwGd2/NiVRRWVSOOtpzm4sc4j1J76nwrUJvvWRlH+AMOfDxoDu03bY2Jb/NtABEB
</span></span><span class=line><span class=cl>AAEAB/9Pw8ZhQYIbcV6+mBCBkNiXFSXfSbtrqbncfpBGrJcYXY628YfbzuzdSPSkXl2/o1Cp
</span></span><span class=line><span class=cl>CmGsYY4JQ4qh3mrNDvoJJv2mJXQysLqRo2Fnf4x5muYRpEbCsyKezgemYJgr6GpNTfyfBc4F
</span></span><span class=line><span class=cl>n8xFoB11X1mVniwKi1FgMXXOC9OFNATFTlK2EjiBCBN1g+AbO31ykqDyhuVjAisQXlrpvRSr
</span></span><span class=line><span class=cl>Jlk3zwNDgyu8jd9NyqCj3wUbp5GTj9/N+JVqm4lxqRAXUJk804w9q4Vn1x5f+lxyOw70m6vV
</span></span><span class=line><span class=cl>9xKZqKB/g2CmqFNVn8nzparvZQ45FSwKFkCz8Z0XrCJG8HvxkS0fBewu2BLBBADvAzcqblpX
</span></span><span class=line><span class=cl>9ygSDsOF/JDt9nhduLcVDgFzOagfZvh9eAny0YGQZ7rue2Vd3DKbMRBkybpn3jKpRbJC8+96
</span></span><span class=line><span class=cl>6AVaaxtoaHt7jKxZMHdjlxRPe6f9rFqETgL4a0+xyGzGd72t2OZG9pXNbydrwJPo0PSybkvR
</span></span><span class=line><span class=cl>hkyd7vP3886X1EkdrwQAwCupzj3qSKf06ATAy+31rKoIUgsHD7OuyrNl7I1FZIMWNttaEl1C
</span></span><span class=line><span class=cl>Z0bYaKHaTZbtoNk9EsISxSIXf3HB7nisKmGDe+LfXD06q9Bk1Tpjoj+zMXhJAm/NOQfbWXgJ
</span></span><span class=line><span class=cl>3/1b6EbI63o1JcBlZDXbrGv5IOY+c7gZqbOc3hD8EThHA6MD/0fQC4TuqH9nkJVyiDp0G+48
</span></span><span class=line><span class=cl>nq2oFDiDEfJ58TiSFlws/K+nuy2uGGO91iJLA6go5B87b0ihvl6A1Z4XFXuopRMcVp87n9gH
</span></span><span class=line><span class=cl>qqRLhvoBqhMdVlfPnYr8JZYu0HkzmFtCnwuQOIA8EH8FQ65ImrP5PopazIHiUwhunrTzoAWp
</span></span><span class=line><span class=cl>/4JOulbNEHRlc3RAZXhhbXBsZS5jb20<span class=o>=</span>
</span></span><span class=line><span class=cl><span class=o>=</span>0fuz
</span></span><span class=line><span class=cl>-----END PGP PRIVATE KEY BLOCK-----
</span></span><span class=line><span class=cl>laptop$
</span></span></code></pre></div><p>They are not valid, generating a valid key that can be imported to
gnupg requires adding a signature packet which means I have to write the
signing code to do that.</p><p>So there we go, either the project ends up as a PGP parsing library that others
may use freely in their PGP implementations or it can evolve into a PGP library
and utility, it depends on how needed and wanted this is by the community.</p><p>I will commit what I have during July.</p><div id=opensmtpd class=anchor></div><h2 class="relative group">OpenSMTPD:
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#opensmtpd aria-label=Anchor>#</a></span></h2><p>What should come as no surprise: I spent most my week working on OpenSMTPD.</p><p>I have tackled two topics:</p><ul><li>migration from the OpenSSL to the libtls API for TLS support</li><li>filters</li></ul><div id=opensmtpd-openssl---libtls-migration class=anchor></div><h2 class="relative group">OpenSMTPD: OpenSSL -> libtls migration
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#opensmtpd-openssl---libtls-migration aria-label=Anchor>#</a></span></h2><p>I have started working on the migration from the OpenSSL API to the libtls API
for TLS support in OpenSMTPD.</p><p>And by &ldquo;I have started&rdquo;, I really mean &ldquo;I&rsquo;m almost done&rdquo;.</p><p>The server side is mostly finished as I just need to rewrite the SNI support
in a slightly different way. The client side is also mostly finished but needs a
bit of cleanup.</p><p>This wasn&rsquo;t as straightforward as I thought it would be, mostly due to the fact
that OpenSMTPD uses a low-level &ldquo;io&rdquo; API for all its network io and that it was
tricky to work on a progressive migration. I eventually found a way that allowed
me to migrate the client-side first, then focus on the server-side, then use
solely libtls. When this will be committed to OpenBSD, it will have to be an
atomic switch, I won&rsquo;t be able to progressively bring server and client side
migrations.</p><p>I also ran into some issues that were not easy to tackle, like the fact that we
used ex data in RSA / EC_KEY objects to pass pki name to the privsep crypto
engine for key lookups &mldr; but libtls already used ex data to pass a checksum.
I could have worked-around but it made sense leaving the checksum in ex data,
as it&rsquo;ll be useful in the future, so a bit of refactoring was require here and
there.</p><p>So libtls-enabled OpenSMTPD is now a thing,
when its finally commited I&rsquo;ll be able to close multiple feature-requests that
will be trivial to implement or already solved by sife-effect of the mgiration.</p><p><strong>Does this mean OpenSMTPD will become LibreSSL only ?</strong></p><p>NOPE.
This means that instead of having OpenSMTPD detect and deal with the differences
between OpenSSL and LibreSSL as well as different OpenSSL versions, it will just
depend on the libtls interface. We can then work on having a portable libtls for
use as a wrapper around OpenSSL. This will then solve the LibreSSL vs OpenSSL vs
different versions of OpenSSL issue for good.</p><div id=opensmtpd-filters class=anchor></div><h2 class="relative group">OpenSMTPD: Filters
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#opensmtpd-filters aria-label=Anchor>#</a></span></h2><p>I have resumed working on filters and this resulted in a few interesting bits.</p><div id=timestamps-in-filter-events class=anchor></div><h2 class="relative group">timestamps in filter events
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#timestamps-in-filter-events aria-label=Anchor>#</a></span></h2><p>Until now,
filter events reported the time at which an event was generated using a time_t
unix timestamp accounting seconds since epoch.</p><p>I had already converted reporting events to use a timeval for sub-second precision,
so I also converted filter events to use a timeval too.</p><div id=filter-strderr-mapped-to-log_warn class=anchor></div><h2 class="relative group">filter strderr mapped to <code>log_warn()</code>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#filter-strderr-mapped-to-log_warn aria-label=Anchor>#</a></span></h2><p>I okayed a diff from <code>martijn@</code> to map the <code>stderr</code> file-descriptor in filters to
an endpoint in smtpd which logs all input with <code>log_warn()</code>.</p><p>This means that a filter calling <code>warnx()</code> or a shell script doing an <code>echo bleh >&amp;2</code> will be logged in <code>maillog</code>,
making it simpler to see output during development and in case of issues in production.</p><div id=filter-eventlog class=anchor></div><h2 class="relative group">filter-eventlog
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#filter-eventlog aria-label=Anchor>#</a></span></h2><p>I have committed to github my first native filter, <code>filter-eventlog</code> which is a
filter written in C that reports ALL smtp-in events to an append-only file, and
creating a new file every day to hold the events of the day.</p><p>This is useful for filter developers as it allows them to check what events are
generated by the daemon and which ones they should listen to in their filters.</p><p>With the lines below in your config:</p><pre tabindex=0><code>[...]

filter mylogs proc-exec &#34;/usr/libexec/filter-eventlog /tmp/logs&#34;

listen on socket filter mylogs

[...]
</code></pre><p>Sending a mail will result in the following being written to files within /tmp/logs:</p><pre tabindex=0><code>report|1|1561888072.457091|smtp-in|link-connect|d812eceafa0ae39e|laptop.home|pass|local:0|local:0
report|1|1561888072.457781|smtp-in|filter-response|d812eceafa0ae39e|connected|proceed
report|1|1561888072.457800|smtp-in|protocol-server|d812eceafa0ae39e|220 laptop.home ESMTP OpenSMTPD
report|1|1561888072.458290|smtp-in|protocol-client|d812eceafa0ae39e|EHLO localhost
report|1|1561888072.458773|smtp-in|filter-response|d812eceafa0ae39e|ehlo|proceed
report|1|1561888072.458778|smtp-in|link-identify|d812eceafa0ae39e|localhost
report|1|1561888072.458784|smtp-in|protocol-server|d812eceafa0ae39e|250-laptop.home Hello localhost [local], pleased to meet you
report|1|1561888072.458787|smtp-in|protocol-server|d812eceafa0ae39e|250-8BITMIME
report|1|1561888072.458790|smtp-in|protocol-server|d812eceafa0ae39e|250-ENHANCEDSTATUSCODES
report|1|1561888072.458794|smtp-in|protocol-server|d812eceafa0ae39e|250-SIZE 36700160
report|1|1561888072.458797|smtp-in|protocol-server|d812eceafa0ae39e|250-DSN
report|1|1561888072.458800|smtp-in|protocol-server|d812eceafa0ae39e|250 HELP
report|1|1561888072.459268|smtp-in|protocol-client|d812eceafa0ae39e|MAIL FROM:&lt;gilles@laptop.home&gt;
report|1|1561888072.459718|smtp-in|filter-response|d812eceafa0ae39e|mail-from|proceed
report|1|1561888072.460764|smtp-in|tx-begin|d812eceafa0ae39e|754cbaa4
report|1|1561888072.460770|smtp-in|tx-mail|d812eceafa0ae39e|754cbaa4|&lt;gilles@laptop.home&gt;  |ok
report|1|1561888072.460774|smtp-in|protocol-server|d812eceafa0ae39e|250 2.0.0: Ok
report|1|1561888072.460995|smtp-in|protocol-client|d812eceafa0ae39e|RCPT TO:&lt;gilles@laptop.home&gt;
report|1|1561888072.461131|smtp-in|filter-response|d812eceafa0ae39e|rcpt-to|proceed
report|1|1561888072.462172|smtp-in|tx-envelope|d812eceafa0ae39e|754cbaa4|754cbaa41a1afada
report|1|1561888072.462180|smtp-in|tx-rcpt|d812eceafa0ae39e|754cbaa4|&lt;gilles@laptop.home&gt; |ok
report|1|1561888072.462184|smtp-in|protocol-server|d812eceafa0ae39e|250 2.1.5 Destination address valid: Recipient ok
report|1|1561888072.462496|smtp-in|protocol-client|d812eceafa0ae39e|DATA
report|1|1561888072.462638|smtp-in|filter-response|d812eceafa0ae39e|data|proceed
report|1|1561888072.463142|smtp-in|tx-data|d812eceafa0ae39e|754cbaa4|ok
report|1|1561888072.463147|smtp-in|protocol-server|d812eceafa0ae39e|354 Enter mail, end with &#34;.&#34; on a line by itself
report|1|1561888072.463866|smtp-in|protocol-client|d812eceafa0ae39e|.
report|1|1561888072.463997|smtp-in|filter-response|d812eceafa0ae39e|commit|proceed
report|1|1561888072.464034|smtp-in|tx-commit|d812eceafa0ae39e|754cbaa4|477
report|1|1561888072.465786|smtp-in|protocol-server|d812eceafa0ae39e|250 2.0.0: 754cbaa4 Message accepted for delivery
report|1|1561888072.466065|smtp-in|protocol-client|d812eceafa0ae39e|QUIT
report|1|1561888072.466294|smtp-in|filter-response|d812eceafa0ae39e|quit|proceed
report|1|1561888072.466300|smtp-in|protocol-server|d812eceafa0ae39e|221 2.0.0: Bye
report|1|1561888072.466481|smtp-in|link-disconnect|d812eceafa0ae39e
</code></pre><div id=libopensmtpd class=anchor></div><h2 class="relative group">libopensmtpd
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#libopensmtpd aria-label=Anchor>#</a></span></h2><p>The filters protocol is a very simple line-based protocol that I already explained in previous blog posts,
but while writing filters in various scripting languages is simple,
writing a filter in C was still a bit tedious.</p><p>I started writing a <code>libopensmtpd</code> to provide a straightforward method for writing native C filters.
It is not ready yet for publishing but it is already functional and works enough to trigger all hooks.</p><p>All it takes is:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ cc -o /tmp/filter-debug debug.c -lopensmtpd
</span></span><span class=line><span class=cl>$
</span></span></code></pre></div><p>To make the following filter usable:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm> * Copyright (c) 2019 Gilles Chehade &lt;gilles@poolp.org&gt;
</span></span></span><span class=line><span class=cl><span class=cm> *
</span></span></span><span class=line><span class=cl><span class=cm> * Permission to use, copy, modify, and distribute this software for any
</span></span></span><span class=line><span class=cl><span class=cm> * purpose with or without fee is hereby granted, provided that the above
</span></span></span><span class=line><span class=cl><span class=cm> * copyright notice and this permission notice appear in all copies.
</span></span></span><span class=line><span class=cl><span class=cm> *
</span></span></span><span class=line><span class=cl><span class=cm> * THE SOFTWARE IS PROVIDED &#34;AS IS&#34; AND THE AUTHOR DISCLAIMS ALL WARRANTIES
</span></span></span><span class=line><span class=cl><span class=cm> * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
</span></span></span><span class=line><span class=cl><span class=cm> * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
</span></span></span><span class=line><span class=cl><span class=cm> * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
</span></span></span><span class=line><span class=cl><span class=cm> * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
</span></span></span><span class=line><span class=cl><span class=cm> * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
</span></span></span><span class=line><span class=cl><span class=cm> * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;err.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;inttypes.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdlib.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;opensmtpd.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=k>extern</span> <span class=kt>char</span> <span class=o>*</span><span class=n>__progname</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/* reporting */</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>report_link_connect</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>rdns</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>fcrdns</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>src</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>dest</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;report_link_connect: rdns=%s, fcrdns=%s, src=%s, dest=%s&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	    <span class=n>rdns</span><span class=p>,</span> <span class=n>fcrdns</span><span class=p>,</span> <span class=n>src</span><span class=p>,</span> <span class=n>dest</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>report_link_disconnect</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;report_link_disconnect&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>report_link_identify</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>helo_name</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;report_link_identify: helo_name=%s&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=n>helo_name</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>report_link_tls</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>tls_line</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;report_link_tls: tls_line=%s&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	    <span class=n>tls_line</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>report_tx_begin</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=kt>uint32_t</span> <span class=n>msgid</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;report_tx_begin: msgid=%08x&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	    <span class=n>msgid</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>report_tx_mail</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=kt>uint32_t</span> <span class=n>msgid</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>mail_from</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;report_tx_mail: msgid=%08x, mail_from=%s, result=%s&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	    <span class=n>msgid</span><span class=p>,</span> <span class=n>mail_from</span><span class=p>,</span> <span class=n>result</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>report_tx_rcpt</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=kt>uint32_t</span> <span class=n>msgid</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>rcpt_to</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;report_tx_rcpt: msgid=%08x, mail_from=%s, result=%s&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	    <span class=n>msgid</span><span class=p>,</span> <span class=n>rcpt_to</span><span class=p>,</span> <span class=n>result</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>report_tx_envelope</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=kt>uint32_t</span> <span class=n>msgid</span><span class=p>,</span> <span class=kt>uint64_t</span> <span class=n>evpid</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;report_tx_envelope: msgid=%08x, evpid=%016&#34;</span><span class=n>PRIx64</span><span class=s>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	    <span class=n>msgid</span><span class=p>,</span> <span class=n>evpid</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>report_tx_commit</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=kt>uint32_t</span> <span class=n>msgid</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;report_tx_commit: msgid=%08x&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	    <span class=n>msgid</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>report_tx_data</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=kt>uint32_t</span> <span class=n>msgid</span><span class=p>,</span> <span class=kt>size_t</span> <span class=n>msg_size</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;report_tx_data: msgid=%08x, msg_size=%zd&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	    <span class=n>msgid</span><span class=p>,</span> <span class=n>msg_size</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>report_tx_rollback</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=kt>uint32_t</span> <span class=n>msgid</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;report_tx_rollback: msgid=%08x&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	    <span class=n>msgid</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>report_protocol_client</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;report_protocol_client: line=%s&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	    <span class=n>line</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>report_protocol_server</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;report_protocol_server: line=%s&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	    <span class=n>line</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>report_filter_response</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>phase</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>response</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;report_filter_response: phase=%s, response=%s&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	    <span class=n>phase</span><span class=p>,</span> <span class=n>response</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>report_timeout</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;report_timeout&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/* filtering */</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>filter_connect</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>rdns</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>arg</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;filter_connect: rdns=%s, arg=%s&#34;</span><span class=p>,</span> <span class=n>rdns</span><span class=p>,</span> <span class=n>arg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>proceed</span><span class=p>(</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>filter_helo</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>arg</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;filter_helo: arg=%s&#34;</span><span class=p>,</span> <span class=n>arg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>proceed</span><span class=p>(</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>filter_ehlo</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>arg</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;filter_ehlo: arg=%s&#34;</span><span class=p>,</span> <span class=n>arg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>proceed</span><span class=p>(</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>filter_starttls</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>arg</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;filter_starttls: arg=%s&#34;</span><span class=p>,</span> <span class=n>arg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>proceed</span><span class=p>(</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>filter_auth</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>arg</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;filter_auth: arg=%s&#34;</span><span class=p>,</span> <span class=n>arg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>proceed</span><span class=p>(</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>filter_mail_from</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>arg</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;filter_mail_from: arg=%s&#34;</span><span class=p>,</span> <span class=n>arg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>proceed</span><span class=p>(</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>filter_rcpt_to</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>arg</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;filter_rcpt_to: arg=%s&#34;</span><span class=p>,</span> <span class=n>arg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>proceed</span><span class=p>(</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>filter_data</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>arg</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;filter_data: arg=%s&#34;</span><span class=p>,</span> <span class=n>arg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>proceed</span><span class=p>(</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>filter_data_line</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>arg</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;filter_data_line: arg=%s&#34;</span><span class=p>,</span> <span class=n>arg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>dataline</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=n>arg</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>filter_rset</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>arg</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;filter_rset: arg=%s&#34;</span><span class=p>,</span> <span class=n>arg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>proceed</span><span class=p>(</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>filter_quit</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>arg</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;filter_quit: arg=%s&#34;</span><span class=p>,</span> <span class=n>arg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>proceed</span><span class=p>(</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>filter_noop</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>arg</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;filter_noop: arg=%s&#34;</span><span class=p>,</span> <span class=n>arg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>proceed</span><span class=p>(</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>filter_help</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>arg</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;filter_help: arg=%s&#34;</span><span class=p>,</span> <span class=n>arg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>proceed</span><span class=p>(</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>filter_wiz</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>arg</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;filter_wiz: arg=%s&#34;</span><span class=p>,</span> <span class=n>arg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>proceed</span><span class=p>(</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>filter_commit</span><span class=p>(</span><span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>arg</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nf>warnx</span><span class=p>(</span><span class=s>&#34;filter_commit: arg=%s&#34;</span><span class=p>,</span> <span class=n>arg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>proceed</span><span class=p>(</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=kt>char</span> <span class=o>*</span><span class=n>argv</span><span class=p>[])</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kt>opensmtpd_ctx_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=p>(</span><span class=n>argc</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nf>errx</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=s>&#34;usage: %s&#34;</span><span class=p>,</span> <span class=n>__progname</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_init</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_report</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;link-connect&#34;</span><span class=p>,</span> <span class=n>report_link_connect</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_report</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;link-disconnect&#34;</span><span class=p>,</span> <span class=n>report_link_disconnect</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_report</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;link-identify&#34;</span><span class=p>,</span> <span class=n>report_link_identify</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_report</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;link-tls&#34;</span><span class=p>,</span> <span class=n>report_link_tls</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_report</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;tx-begin&#34;</span><span class=p>,</span> <span class=n>report_tx_begin</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_report</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;tx-mail&#34;</span><span class=p>,</span> <span class=n>report_tx_mail</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_report</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;tx-rcpt&#34;</span><span class=p>,</span> <span class=n>report_tx_rcpt</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_report</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;tx-envelope&#34;</span><span class=p>,</span> <span class=n>report_tx_envelope</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_report</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;tx-data&#34;</span><span class=p>,</span> <span class=n>report_tx_data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_report</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;tx-commit&#34;</span><span class=p>,</span> <span class=n>report_tx_commit</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_report</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;tx-rollback&#34;</span><span class=p>,</span> <span class=n>report_tx_rollback</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_report</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;protocol-client&#34;</span><span class=p>,</span> <span class=n>report_protocol_client</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_report</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;protocol-server&#34;</span><span class=p>,</span> <span class=n>report_protocol_server</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_report</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;filter-response&#34;</span><span class=p>,</span> <span class=n>report_filter_response</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_report</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;timeout&#34;</span><span class=p>,</span> <span class=n>report_timeout</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_filter</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;connect&#34;</span><span class=p>,</span> <span class=n>filter_connect</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_filter</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;helo&#34;</span><span class=p>,</span> <span class=n>filter_helo</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_filter</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;ehlo&#34;</span><span class=p>,</span> <span class=n>filter_ehlo</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_filter</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;starttls&#34;</span><span class=p>,</span> <span class=n>filter_starttls</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_filter</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;auth&#34;</span><span class=p>,</span> <span class=n>filter_auth</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_filter</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;mail-from&#34;</span><span class=p>,</span> <span class=n>filter_mail_from</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_filter</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;rcpt-to&#34;</span><span class=p>,</span> <span class=n>filter_rcpt_to</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_filter</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;data&#34;</span><span class=p>,</span> <span class=n>filter_data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_filter</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;rset&#34;</span><span class=p>,</span> <span class=n>filter_rset</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_filter</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;quit&#34;</span><span class=p>,</span> <span class=n>filter_quit</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_filter</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;noop&#34;</span><span class=p>,</span> <span class=n>filter_noop</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_filter</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;help&#34;</span><span class=p>,</span> <span class=n>filter_help</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_filter</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;wiz&#34;</span><span class=p>,</span> <span class=n>filter_wiz</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_filter</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;commit&#34;</span><span class=p>,</span> <span class=n>filter_commit</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nf>smtpd_on_filter</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=s>&#34;smtp-in&#34;</span><span class=p>,</span> <span class=s>&#34;data-line&#34;</span><span class=p>,</span> <span class=n>filter_data_line</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=p>(</span><span class=o>!</span> <span class=nf>smtpd_event_loop</span><span class=p>(</span><span class=n>ctx</span><span class=p>))</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>and register all hooks:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>laptop$ /tmp/filter-debug
</span></span><span class=line><span class=cl>register<span class=p>|</span>report<span class=p>|</span>smtp-in<span class=p>|</span>filter-response
</span></span><span class=line><span class=cl>register<span class=p>|</span>report<span class=p>|</span>smtp-in<span class=p>|</span>link-connect
</span></span><span class=line><span class=cl>register<span class=p>|</span>report<span class=p>|</span>smtp-in<span class=p>|</span>link-disconnect
</span></span><span class=line><span class=cl>register<span class=p>|</span>report<span class=p>|</span>smtp-in<span class=p>|</span>link-identify
</span></span><span class=line><span class=cl>register<span class=p>|</span>report<span class=p>|</span>smtp-in<span class=p>|</span>link-tls
</span></span><span class=line><span class=cl>register<span class=p>|</span>report<span class=p>|</span>smtp-in<span class=p>|</span>protocol-client
</span></span><span class=line><span class=cl>register<span class=p>|</span>report<span class=p>|</span>smtp-in<span class=p>|</span>protocol-server
</span></span><span class=line><span class=cl>register<span class=p>|</span>report<span class=p>|</span>smtp-in<span class=p>|</span>timeout
</span></span><span class=line><span class=cl>register<span class=p>|</span>report<span class=p>|</span>smtp-in<span class=p>|</span>tx-begin
</span></span><span class=line><span class=cl>register<span class=p>|</span>report<span class=p>|</span>smtp-in<span class=p>|</span>tx-commit
</span></span><span class=line><span class=cl>register<span class=p>|</span>report<span class=p>|</span>smtp-in<span class=p>|</span>tx-data
</span></span><span class=line><span class=cl>register<span class=p>|</span>report<span class=p>|</span>smtp-in<span class=p>|</span>tx-envelope
</span></span><span class=line><span class=cl>register<span class=p>|</span>report<span class=p>|</span>smtp-in<span class=p>|</span>tx-mail
</span></span><span class=line><span class=cl>register<span class=p>|</span>report<span class=p>|</span>smtp-in<span class=p>|</span>tx-rcpt
</span></span><span class=line><span class=cl>register<span class=p>|</span>report<span class=p>|</span>smtp-in<span class=p>|</span>tx-rollback
</span></span><span class=line><span class=cl>register<span class=p>|</span>filter<span class=p>|</span>smtp-in<span class=p>|</span>auth
</span></span><span class=line><span class=cl>register<span class=p>|</span>filter<span class=p>|</span>smtp-in<span class=p>|</span>commit
</span></span><span class=line><span class=cl>register<span class=p>|</span>filter<span class=p>|</span>smtp-in<span class=p>|</span>connect
</span></span><span class=line><span class=cl>register<span class=p>|</span>filter<span class=p>|</span>smtp-in<span class=p>|</span>data
</span></span><span class=line><span class=cl>register<span class=p>|</span>filter<span class=p>|</span>smtp-in<span class=p>|</span>data-line
</span></span><span class=line><span class=cl>register<span class=p>|</span>filter<span class=p>|</span>smtp-in<span class=p>|</span>ehlo
</span></span><span class=line><span class=cl>register<span class=p>|</span>filter<span class=p>|</span>smtp-in<span class=p>|</span>helo
</span></span><span class=line><span class=cl>register<span class=p>|</span>filter<span class=p>|</span>smtp-in<span class=p>|</span><span class=nb>help</span>
</span></span><span class=line><span class=cl>register<span class=p>|</span>filter<span class=p>|</span>smtp-in<span class=p>|</span>mail-from
</span></span><span class=line><span class=cl>register<span class=p>|</span>filter<span class=p>|</span>smtp-in<span class=p>|</span>noop
</span></span><span class=line><span class=cl>register<span class=p>|</span>filter<span class=p>|</span>smtp-in<span class=p>|</span>quit
</span></span><span class=line><span class=cl>register<span class=p>|</span>filter<span class=p>|</span>smtp-in<span class=p>|</span>rcpt-to
</span></span><span class=line><span class=cl>register<span class=p>|</span>filter<span class=p>|</span>smtp-in<span class=p>|</span>rset
</span></span><span class=line><span class=cl>register<span class=p>|</span>filter<span class=p>|</span>smtp-in<span class=p>|</span>starttls
</span></span><span class=line><span class=cl>register<span class=p>|</span>filter<span class=p>|</span>smtp-in<span class=p>|</span>wiz
</span></span><span class=line><span class=cl>register<span class=p>|</span>ready
</span></span><span class=line><span class=cl>^C
</span></span><span class=line><span class=cl>laptop$
</span></span></code></pre></div><p>In OpenSMTPD, with the following config:</p><pre tabindex=0><code>[...]
filter foobar proc-exec &#34;/tmp/filter-debug&#34;

listen on socket filter foobar
</code></pre><p>it will result in the following output:</p><pre tabindex=0><code>[...]
86c0820a13ffee17 smtp connected address=local host=laptop.home
&lt;dynproc:00000001&gt;: filter-debug: report_link_connect: rdns=laptop.home, fcrdns=pass, src=local:0, dest=local:0
&lt;dynproc:00000001&gt;: filter-debug: filter_connect: rdns=laptop.home, arg=local
&lt;dynproc:00000001&gt;: filter-debug: report_filter_response: phase=connected, response=proceed
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_server: line=220 laptop.home ESMTP OpenSMTPD
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_client: line=EHLO localhost
&lt;dynproc:00000001&gt;: filter-debug: filter_ehlo: arg=localhost
&lt;dynproc:00000001&gt;: filter-debug: report_filter_response: phase=ehlo, response=proceed
&lt;dynproc:00000001&gt;: filter-debug: report_link_identify: helo_name=localhost
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_server: line=250-laptop.home Hello localhost [local], pleased to meet you
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_server: line=250-8BITMIME
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_server: line=250-ENHANCEDSTATUSCODES
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_server: line=250-SIZE 36700160
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_server: line=250-DSN
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_server: line=250 HELP
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_client: line=MAIL FROM:&lt;gilles@laptop.home&gt;
&lt;dynproc:00000001&gt;: filter-debug: filter_mail_from: arg=gilles@laptop.home
&lt;dynproc:00000001&gt;: filter-debug: report_filter_response: phase=mail-from, response=proceed
&lt;dynproc:00000001&gt;: filter-debug: report_tx_begin: msgid=2b8bbe3b
&lt;dynproc:00000001&gt;: filter-debug: report_tx_mail: msgid=2b8bbe3b, mail_from=&lt;gilles@laptop.home&gt;, result=ok
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_server: line=250 2.0.0: Ok
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_client: line=RCPT TO:&lt;gilles@laptop.home&gt;
&lt;dynproc:00000001&gt;: filter-debug: filter_rcpt_to: arg=gilles@laptop.home
&lt;dynproc:00000001&gt;: filter-debug: report_filter_response: phase=rcpt-to, response=proceed
&lt;dynproc:00000001&gt;: filter-debug: report_tx_envelope: msgid=2b8bbe3b, evpid=2b8bbe3b60567a11
&lt;dynproc:00000001&gt;: filter-debug: report_tx_rcpt: msgid=2b8bbe3b, mail_from=&lt;gilles@laptop.home&gt;, result=ok
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_server: line=250 2.1.5 Destination address valid: Recipient ok
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_client: line=DATA
&lt;dynproc:00000001&gt;: filter-debug: filter_data: arg=
&lt;dynproc:00000001&gt;: filter-debug: report_filter_response: phase=data, response=proceed
&lt;dynproc:00000001&gt;: filter-debug: filter_data_line: arg=Received: from localhost (laptop.home [local])
&lt;dynproc:00000001&gt;: filter-debug: filter_data_line: arg=        by laptop.home (OpenSMTPD) with ESMTPA id 2b8bbe3b
&lt;dynproc:00000001&gt;: filter-debug: filter_data_line: arg=        for &lt;gilles@laptop.home&gt;;
&lt;dynproc:00000001&gt;: filter-debug: filter_data_line: arg=        Sun, 30 Jun 2019 12:01:55 +0200 (CEST)
&lt;dynproc:00000001&gt;: filter-debug: report_tx_data: msgid=2b8bbe3b, msg_size=10034375646789
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_server: line=354 Enter mail, end with &#34;.&#34; on a line by itself
&lt;dynproc:00000001&gt;: filter-debug: filter_data_line: arg=From:  &lt;gilles@laptop.home&gt;
&lt;dynproc:00000001&gt;: filter-debug: filter_data_line: arg=Date: Sun, 30 Jun 2019 12:01:55 +0200 (CEST)
&lt;dynproc:00000001&gt;: filter-debug: filter_data_line: arg=To: gilles
&lt;dynproc:00000001&gt;: filter-debug: filter_data_line: arg=
&lt;dynproc:00000001&gt;: filter-debug: filter_data_line: arg=test
&lt;dynproc:00000001&gt;: filter-debug: filter_data_line: arg=.
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_client: line=.
&lt;dynproc:00000001&gt;: filter-debug: filter_commit: arg=
&lt;dynproc:00000001&gt;: filter-debug: report_filter_response: phase=commit, response=proceed
&lt;dynproc:00000001&gt;: filter-debug: report_tx_commit: msgid=2b8bbe3b
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_server: line=250 2.0.0: 2b8bbe3b Message accepted for delivery
&lt;dynproc:00000001&gt;: filter-debug: report_protocol_client: line=QUIT
&lt;dynproc:00000001&gt;: filter-debug: filter_quit: arg=
[...]
</code></pre><div id=filter-rspamd-in-progress class=anchor></div><h2 class="relative group">filter-rspamd in progress
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#filter-rspamd-in-progress aria-label=Anchor>#</a></span></h2><p>I had written a filter-rspamd for OpenSMTPD in python already,
however it was a proof-of-concept more than a real filter and I didn&rsquo;t make it really robust.</p><p>With <code>libopensmtpd</code> at hands,
I decided to write a native C filter-rspamd that I would officially maintain,
one that would be robust enough to be used in production.</p><p>I had most of the logic done in half an hour,
unfortunately I ran out of time for this &ldquo;free&rdquo; week and didn&rsquo;t complete the filter.</p><p>Basically as it is right now, the filter will build everything needed for the call to <code>rspamd</code>,
but I didn&rsquo;t write the http request.</p><p>I will surely finish that during my next &ldquo;free&rdquo; week.</p><div id=what-next- class=anchor></div><h2 class="relative group">What next ?
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#what-next- aria-label=Anchor>#</a></span></h2><p>Well, see you in a month for the July report.</p><p>Hopefully, by then I will have finished my filter-rspamd, I will have released an initial version of FION,
and I will have released an initial version of libopensmtpd.</p><p>When I&rsquo;m done with FION and have decided what to to with BPG,
I will have a look at some of my other private repositories to see what can be released :-)</p><p>If you like my work, <a href=https://patreon.com/gilles target=_blank>support me on patreon</a> !</p><hr><p>Comments: <a href=https://github.com/poolpOrg/poolp.org/discussions/102 target=_blank>https://github.com/poolpOrg/poolp.org/discussions/102</a></p></br></br></div><script>var oid="views_posts/2019-06-30/index.md",oid_likes="likes_posts/2019-06-30/index.md"</script><script type=text/javascript src=/js/page.min.0e49973b4ad0a382c7c6012d8bff8226316642daabc4f8a20477bd08674f3da6e2fa993bc20ad4f51e7c5bb68e6f913a207a7c4fe37ea0e7b806894afce0a64e.js integrity="sha512-DkmXO0rQo4LHxgEti/+CJjFmQtqrxPiiBHe9CGdPPabi+pk7wgrU9R58W7aOb5E6IHp8T+N+oOe4BolK/OCmTg=="></script></section><footer class="pt-8 max-w-prose print:hidden"><section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://poolp.org/posts/2019-06-30/june-2019-report-fion-bpg-and-smtpd/&amp;title=June%202019%20report:%20fion,%20bpg%20and%20smtpd" title="Share on LinkedIn" aria-label="Share on LinkedIn"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://twitter.com/intent/tweet/?url=https://poolp.org/posts/2019-06-30/june-2019-report-fion-bpg-and-smtpd/&amp;text=June%202019%20report:%20fion,%20bpg%20and%20smtpd" title="Tweet on Twitter" aria-label="Tweet on Twitter"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://reddit.com/submit/?url=https://poolp.org/posts/2019-06-30/june-2019-report-fion-bpg-and-smtpd/&amp;resubmit=true&amp;title=June%202019%20report:%20fion,%20bpg%20and%20smtpd" title="Submit to Reddit" aria-label="Submit to Reddit"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M201.5 305.5c-13.8.0-24.9-11.1-24.9-24.6.0-13.8 11.1-24.9 24.9-24.9 13.6.0 24.6 11.1 24.6 24.9.0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4.0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7.0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9.0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5.0 52.6 59.2 95.2 132 95.2 73.1.0 132.3-42.6 132.3-95.2.0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6.0-2.2-2.2-6.1-2.2-8.3.0-2.5 2.5-2.5 6.4.0 8.6 22.8 22.8 87.3 22.8 110.2.0 2.5-2.2 2.5-6.1.0-8.6-2.2-2.2-6.1-2.2-8.3.0zm7.7-75c-13.6.0-24.6 11.1-24.6 24.9.0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.1 24.9-24.6.0-13.8-11-24.9-24.9-24.9z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://pinterest.com/pin/create/bookmarklet/?url=https://poolp.org/posts/2019-06-30/june-2019-report-fion-bpg-and-smtpd/&amp;description=June%202019%20report:%20fion,%20bpg%20and%20smtpd" title="Pin on Pinterest" aria-label="Pin on Pinterest"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M496 256c0 137-111 248-248 248-25.6.0-50.2-3.9-73.4-11.1 10.1-16.5 25.2-43.5 30.8-65 3-11.6 15.4-59 15.4-59 8.1 15.4 31.7 28.5 56.8 28.5 74.8.0 128.7-68.8 128.7-154.3.0-81.9-66.9-143.2-152.9-143.2-107 0-163.9 71.8-163.9 150.1.0 36.4 19.4 81.7 50.3 96.1 4.7 2.2 7.2 1.2 8.3-3.3.8-3.4 5-20.3 6.9-28.1.6-2.5.3-4.7-1.7-7.1-10.1-12.5-18.3-35.3-18.3-56.6.0-54.7 41.4-107.6 112-107.6 60.9.0 103.6 41.5 103.6 100.9.0 67.1-33.9 113.6-78 113.6-24.3.0-42.6-20.1-36.7-44.8 7-29.5 20.5-61.3 20.5-82.6.0-19-10.2-34.9-31.4-34.9-24.9.0-44.9 25.7-44.9 60.2.0 22 7.4 36.8 7.4 36.8s-24.5 103.8-29 123.2c-5 21.4-3 51.6-.9 71.2C65.4 450.9.0 361.1.0 256 0 119 111 8 248 8s248 111 248 248z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.facebook.com/sharer/sharer.php?u=https://poolp.org/posts/2019-06-30/june-2019-report-fion-bpg-and-smtpd/&amp;quote=June%202019%20report:%20fion,%20bpg%20and%20smtpd" title="Share on Facebook" aria-label="Share on Facebook"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14.0 55.52 4.84 55.52 4.84v61h-31.28c-30.8.0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:?body=https://poolp.org/posts/2019-06-30/june-2019-report-fion-bpg-and-smtpd/&amp;subject=June%202019%20report:%20fion,%20bpg%20and%20smtpd" title="Send via email" aria-label="Send via email"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://api.whatsapp.com/send?text=https://poolp.org/posts/2019-06-30/june-2019-report-fion-bpg-and-smtpd/&amp;resubmit=true&amp;title=June%202019%20report:%20fion,%20bpg%20and%20smtpd" title aria-label><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4.0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3.0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2.0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2.0-101.7 82.8-184.5 184.6-184.5 49.3.0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5.0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8s-14.3 18-17.6 21.8c-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2s-9.7 1.4-14.8 6.9c-5.1 5.6-19.4 19-19.4 46.3.0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://t.me/share/url?url=https://poolp.org/posts/2019-06-30/june-2019-report-fion-bpg-and-smtpd/&amp;resubmit=true&amp;title=June%202019%20report:%20fion,%20bpg%20and%20smtpd" title aria-label><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M248 8C111.033 8 0 119.033.0 256S111.033 504 248 504 496 392.967 496 256 384.967 8 248 8zM362.952 176.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452.0 013.53 6.716A43.765 43.765.0 01362.952 176.66z"/></svg></span></a></section><h2 class="mt-8 text-2xl font-extrabold mb-10">Related</h2><section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3"><a href=/posts/2018-12-21/opensmtpd-now-supports-regex-in-match-rules/ class=min-w-full><div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative backdrop-blur"><div class="px-6 py-4"><div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral" href=/posts/2018-12-21/opensmtpd-now-supports-regex-in-match-rules/>OpenSMTPD now supports regex in match rules</div><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime="2018-12-21 22:36:00 +0000 UTC">21 December 2018</time><span class="px-2 text-primary-500">&#183;</span><span>311 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">2 mins</span></div><div class="flex flex-row flex-wrap items-center"><div style=cursor:pointer onclick='window.open("/authors/gilles/","_self")'>Gilles Chehade</div></div><div class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/categories/technology/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">technology</span></span></span></div></div><div class="py-1 prose dark:prose-invert">TL;DR: regex table lookups were introduced for builtin filters. After a few weeks of working solely on filters, I wanted to work on something else. Using the same mechanism, all match criterias using tables can support regex.</div></div><div class="px-6 pt-4 pb-2"></div></div></a><a href=/posts/2018-12-19/more-on-opensmtpd-filters/ class=min-w-full><div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative backdrop-blur"><div class="px-6 py-4"><div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral" href=/posts/2018-12-19/more-on-opensmtpd-filters/>more on OpenSMTPD filters</div><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime="2018-12-19 18:21:00 +0000 UTC">19 December 2018</time><span class="px-2 text-primary-500">&#183;</span><span>1838 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">9 mins</span></div><div class="flex flex-row flex-wrap items-center"><div style=cursor:pointer onclick='window.open("/authors/gilles/","_self")'>Gilles Chehade</div></div><div class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/categories/technology/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">technology</span></span></span></div></div><div class="py-1 prose dark:prose-invert">TL;DR: Not this time, pal/gal, I took hours writing this post, you'll take a few minutes reading it all. Oh, and merry X-mas :-* A bit of short-sighted history # The filtering feature has been introduced only recently in OpenSMTPD, first presented on this blog a month ago.</div></div><div class="px-6 pt-4 pb-2"></div></div></a><a href=/posts/2018-12-06/opensmtpd-proc-filters-fc-rdns/ class=min-w-full><div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative backdrop-blur"><div class="px-6 py-4"><div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral" href=/posts/2018-12-06/opensmtpd-proc-filters-fc-rdns/>OpenSMTPD proc filters & fc-rDNS</div><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime="2018-12-06 21:31:00 +0000 UTC">6 December 2018</time><span class="px-2 text-primary-500">&#183;</span><span>657 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">4 mins</span></div><div class="flex flex-row flex-wrap items-center"><div style=cursor:pointer onclick='window.open("/authors/gilles/","_self")'>Gilles Chehade</div></div><div class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/categories/technology/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">technology</span></span></span></div></div><div class="py-1 prose dark:prose-invert">TL;DR: I *FINALFUCKINGLY* commited proc filters support allowing full filtering in OpenSMTPD. eric@ implemented fc-rDNS lookups. fc-rDNS # fc-rDNS, or forward-confirmed reverse DNS, consists in performing a reverse DNS lookup to determine the hostname associated to an IP address&mldr; then performing a DNS lookup on that hostname to check if it resolves back to the IP address.</div></div><div class="px-6 pt-4 pb-2"></div></div></a></section><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="flex group mr-3" href=/posts/2019-06-02/may-2019-report/><span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">May 2019 report</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2019-06-02 14:57:00 +0000 UTC">2 June 2019</time></span></span></a></span>
<span><a class="flex text-right group ml-3" href=/posts/2019-07-27/july-2019-report-tons-of-smtpd-work-mostly/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">July 2019 report: tons of smtpd work mostly</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2019-07-27 07:27:00 +0000 UTC">27 July 2019</time></span></span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span></a></span></div></div><div class=pt-3><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class=pt-3><script src=https://giscus.app/client.js data-repo=poolpOrg/poolp.org data-repo-id="MDEwOlJlcG9zaXRvcnkxMjYxODk2MjA=" data-category=Articles data-category-id=DIC_kwDOB4WANM4B-Zf1 data-mapping=og:title data-strict=0 data-reactions-enabled=1 data-emit-metadata=1 data-input-position=top data-theme=light data-lang=en data-loading=lazy crossorigin=anonymous async></script></div></div></footer></article><div id=top-scroller class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex flex-col list-none sm:flex-row"><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/tags/ title=Tags>Tags</a></li><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/categories/ title=Categories>Categories</a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2023</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.35c1113bcc16c5a59bf031082f9e63822aa95280423881a7847a7ff33a16e6299ce6a840d9ef4e10d947e030a18f3f20359afb2ec0f35967484b9a9360ac3145.js integrity="sha512-NcERO8wWxaWb8DEIL55jgiqpUoBCOIGnhHp/8zoW5imc5qhA2e9OENlH4DChjz8gNZr7LsDzWWdIS5qTYKwxRQ=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://poolp.org style=z-index:500><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body><script data-name=BMC-Widget data-cfasync=false src=https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js data-id=poolporg data-description="Support me on Buy me a coffee!" data-message="Support me !" data-color=#FFDD00 data-position=Left data-x_margin=18 data-y_margin=18></script></html>